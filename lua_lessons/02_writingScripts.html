<!DOCTYPE html>

<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/assets/css/style.css">
  <!--<link rel="icon" type="image/png" href="/assets/civfanatics_icon.png">-->
    <title></title>
    <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Lua for Civilization II" />
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Lua for Civilization II | Reference materials and lessons for using Lua to program events for Civilization II: Test of Time</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Lua for Civilization II" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Reference materials and lessons for using Lua to program events for Civilization II: Test of Time" />
<meta property="og:description" content="Reference materials and lessons for using Lua to program events for Civilization II: Test of Time" />
<link rel="canonical" href="http://localhost:4000/lua_lessons/02_writingScripts.html" />
<meta property="og:url" content="http://localhost:4000/lua_lessons/02_writingScripts.html" />
<meta property="og:site_name" content="Lua for Civilization II" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Lua for Civilization II" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Reference materials and lessons for using Lua to program events for Civilization II: Test of Time","headline":"Lua for Civilization II","url":"http://localhost:4000/lua_lessons/02_writingScripts.html"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body><header class="site-header">
  <div class="wrapper">
    <!--img src="/assets/logo-cfc.png" class="center"--><a class="site-title" rel="author" href="/">Lua for Civilization II</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/auto_doc/autoIndex.html">Function Docs</a><a class="page-link" href="/executionPoints.html">Execution Points</a><a class="page-link" href="/lua_lessons/lessons_toc.html">Lua Lessons</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <head><title>Writing Programs (Lesson 2)</title>
</head>
<article class="post">

  <header class="post-header">
    <h1 class="post-title"></h1>
  </header>
  
  <div class="post-content">
    <table>
  <tbody>
    <tr>
      <td>Previous: <a href="01_helloWorld.html">Hello World</a></td>
      <td>Next: <a href="03_valuesAndVariables.html">Values and Variables</a></td>
    </tr>
  </tbody>
</table>
<h1 id="writing-programs">
  
  
    Writing Programs <a href="#writing-programs"><span class="self-link">&#128279</span></a>
  
  
</h1>
    
<h2 id="introduction">
  
  
    Introduction <a href="#introduction"><span class="self-link">&#128279</span></a>
  
  
</h2>
    

<p>In <a href="01_helloWorld.html">Lesson 1</a>, we wrote code directly into the Lua Console, and it executed those commands immediately.  Usually, however, we will want to write our code ahead of time and run it all at once.  In this lesson, we will download the software to create and change Lua files, write some programs, and run them in the Lua Console.</p>
<h2 id="setting-up-our-programming-environment">
  
  
    Setting Up Our Programming Environment <a href="#setting-up-our-programming-environment"><span class="self-link">&#128279</span></a>
  
  
</h2>
    

<p>In order to write programs in Lua (or any programming language) you will need to use a special kind of program called a “text editor.”  This is NOT the same thing as a “word processor.”  A program like Libre Office Writer or Microsoft Word will not work for our purposes.  Lua programs are written in “plain text” format, which is to say that the file is just a sequence of letters, numbers, special characters, spaces, etc.  There is no extra data for stuff like formatting or fonts.</p>

<p>In plain text, an A is an A is an A.  But in a Word document, you could have an A or an <em>A</em> or an <strong>A</strong> or an <span style="font-size:30px">A</span>.  That extra information doesn’t exist in a plain text file.  The rules.txt, game.txt, and events.txt files are all examples of text files.  A text editor is a program designed for writing and changing text files, and provides features useful for programming such as different colors for different programming elements.</p>

<p>Some text editors have a lot of features useful for programmers, and are called “Integrated Development Environments,” or IDEs.  For these lessons, I will be using <a href="https://code.visualstudio.com/">Visual Studio Code</a>, which is an IDE, but I would recommend also installing <a href="https://notepad-plus-plus.org/">notepad++</a> or some other more “lightweight” text editor for when you just want to take a look at an individual file.</p>

<p>Download and install Visual Studio Code (VS Code).  Default installation choices are probably fine, except that during Select Additional Tasks, you should probably enable all the “other” options:</p>

<p><img src="02_lesson_images/install-additional-tasks.png" alt="additional tasks" /></p>

<p>The first time you open Visual Studio Code, it will probably look something like this:</p>

<p><img src="02_lesson_images/vs-code-first-image.png" alt="First VS Code Screen" /></p>

<p>You should choose a theme here.  I will be using Dark Modern for these lessons, so, you should do the same if you want syntax colours to match what I’m using.  Note that VS Code prints unused code in a slightly lighter shade.  This is a fine feature (it alerts you to code you might want to delete), but it often applies to the code you are currently writing, and you might find that a light theme doesn’t contrast enough with the code.  That is why I chose a dark theme.</p>

<p>You can always change your theme, by selecting this menu sequence:</p>

<p><img src="02_lesson_images/theme-change-menu.png" alt="Menu choices to change theme" /></p>

<p>We don’t have to worry about any of the other stuff in the welcome window for now.  Instead, we will install the <a href="https://github.com/LuaLS/lua-language-server#lua-language-server">Lua Language Server</a> Extension, by sumneko.</p>

<p>Click on the extensions icon <img src="02_lesson_images/extensions-icon.png" alt="extensions icon" /> and search for Lua Language Server.  Make sure that sumneko is the author, so you get the correct one.</p>

<p><img src="02_lesson_images/lua-ls-extension.png" alt="Lua Language Server Installation" /></p>
<h2 id="writing-a-script">
  
  
    Writing a Script <a href="#writing-a-script"><span class="self-link">&#128279</span></a>
  
  
</h2>
    

<p>Now, we will write a “script,” which is just another way of saying program.  In VS Code, select Open Folder from the drop down File menu</p>

<p><img src="02_lesson_images/open-folder.png" alt="Open Folder" /></p>

<p>And navigate to and select the <strong>lua</strong> folder within your <strong>Test of Time</strong> directory.  (You may not see any files within the directory in the navigation window.)  You may be asked if you trust the files in the folder.  Say that you do.</p>

<p>This folder will already contain a few files.  We won’t be using any of them.  Instead, create a new text file.  You can right click within the file explorer, (which you can open with the <img src="02_lesson_images/explore-icon.png" alt="file explorer icon" /> button), or use the new file button (you will have to hover your mouse there for the icons to appear):</p>

<p><img src="02_lesson_images/new-file.png" alt="New File Button" /></p>

<p>Name the file <strong>pinafore.lua</strong>.  Your VS Code window will now look something like this:</p>

<p><img src="02_lesson_images/ready-to-work.png" alt="Ready to Work" /></p>

<p>You might have noticed that the other .lua files are now highlighted in yellow.  This is because the Lua Language Server has detected potential mistakes in those files.  If a file is known <em>for sure</em> to have an error, it will be highlighted in red.  Don’t worry about the other files.</p>

<p>Copy the following code into <strong>pinafore.lua</strong> (although I suggest you usually type the code in yourself, in this case you might as well copy and paste most of it):</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">print</span><span class="p">(</span><span class="s2">"I am the Captain of the Pinafore;"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"And a right good captain, too!"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"You're very, very good,"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"And be it understood,"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"I command a right good crew."</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"We're very, very good,"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"And be it understood,"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"He commands a right good crew."</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Though related to a peer,"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"I can hand, reef, and steer,"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"And ship a selvagee;"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"I am never known to quail"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"At the fury of a gale,"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"And I'm never, never sick at sea!"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"What, never?"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"No, never!"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"What, never?"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Hardly ever!"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"He's hardly ever sick at sea!"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Then give three cheers, and one cheer more,"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"For the hardy Captain of the Pinafore!"</span><span class="p">)</span>
</code></pre></div></div>
<p>(<a href="https://www.youtube.com/watch?v=c548RjB8jzQ">This song</a> is from the Gilbert and Sullivan play H.M.S. Pinafore)</p>

<p>If you start to type out the above code, Visual Studio Code will start offering suggestions in a suggestion box, like this:</p>

<p><img src="02_lesson_images/suggestion-while-typing.png" alt="suggestion box" /></p>

<p>Ignore the suggestions and information in these boxes for now.  Eventually, they will be helpful.</p>

<p>Once you’ve copied the code, you should notice a few things about VS Code.</p>

<ol>
  <li>The file explorer icon has a circle with a 1 in it.  This means there is one unsaved file.</li>
  <li>The tab for <strong>pinafore.lua</strong> also has a circle, instead of an x. This means that <strong>pinafore.lua</strong> is unsaved.</li>
  <li>Each line in the editor has a number beside it, to tell you what line of the file it is.</li>
</ol>

<p><img src="02_lesson_images/unsaved-pinafore.png" alt="Pinafore.lua is unsaved" /></p>

<p>Under the File menu, choose Save All.</p>

<p>Now, start a new Original game and open the Lua Console (just as we did in Lesson 1).  Press the Load Script button in the bottom right, navigate to the <strong>Test of Time\lua</strong> folder, and choose <strong>pinafore.lua</strong>.  Note: Depending on your settings, Windows might hide the .lua extension, but the “Type” will be “Lua Source File.”</p>

<p><img src="02_lesson_images/load-script.png" alt="Load Script" /></p>

<p><img src="02_lesson_images/open-pinafore.png" alt="Open Pinafore.lua" /></p>

<p>All the print commands are immediately executed, in order, and the song is printed to the console:</p>

<p><img src="02_lesson_images/pinafore-print-1.png" alt="I am the captain of the pinafore" /></p>

<p>Note that Lua (or any programming language) will blindly follow your instructions, regardless of what makes sense.  For example, if we swap lines 1 and 3 in <strong>pinafore.lua</strong>, save, and run the script again with Load Script, the Lua Console will happily print our song, even though it makes no sense to us:</p>

<p><img src="02_lesson_images/mixed-up-song.png" alt="Lines 3 and 1 swapped" /></p>

<p><img src="02_lesson_images/print-mixed-up-song.png" alt="Printed Mixed Up Song" /></p>

<p>In addition to printing a nonsensical start to the song, the Lua Console didn’t even split the last line of the first rendition from the first line of the second rendition.  Why not?  We didn’t tell it to, so it had no way of knowing that it would be a good idea to do that.</p>

<p>It probably makes sense to have an empty line at the start and end of this script.  We will do this in two different ways.  Change the print statements back to their original order, then insert this line as a new first line:</p>
<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
</code></pre></div></div>
<p>This will print an empty line before the song starts.  At the end, we’ll do something a bit different.  Change the last line (formerly line 21, now line 22) to</p>
<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">print</span><span class="p">(</span><span class="s2">"For the hardy Captain of the Pinafore!\n"</span><span class="p">)</span>
</code></pre></div></div>
<p>Up to this point, the <code class="language-plaintext highlighter-rouge">print</code> command has printed every character between <code class="language-plaintext highlighter-rouge">"</code> marks to the console, just as we wrote it.  However, the <code class="language-plaintext highlighter-rouge">\</code> indicates that it and the next character should be interpreted as a single character.  In this case, <code class="language-plaintext highlighter-rouge">\n</code> represents the “newline” character, which tells the Lua Console to move to the next line.</p>

<p><strong>pinafore.lua</strong> will now look like this:</p>

<p><img src="02_lesson_images/pinafore-with-newlines.png" alt="pinafore.lua with spaces" /></p>

<p>Save and load the <strong>pinafore.lua</strong> script a couple more times.  The first time, you will see 1 empty line between the end of the previous rendition, and the start of the next one.  The second time, you will see two empty lines, one of which was created at the end of a rendition, and the next created at the start of one.</p>

<p><img src="02_lesson_images/pinafore-single-double.png" alt="pinafore rendition spacing" /></p>
<h2 id="adding-comments-in-code">
  
  
    Adding Comments in Code <a href="#adding-comments-in-code"><span class="self-link">&#128279</span></a>
  
  
</h2>
    

<p>So far, the Lua Console has done something with every character written in <strong>pinafore.lua</strong>.  The command <code class="language-plaintext highlighter-rouge">print</code> along with <code class="language-plaintext highlighter-rouge">("</code> and <code class="language-plaintext highlighter-rouge">")</code> has told Lua that we want stuff printed to the console window, and the characters between the <code class="language-plaintext highlighter-rouge">"</code> marks were actually printed.  In this section, we will write “comments” in our code, which Lua will ignore.</p>

<p>Save your game, and then load it again.  This will clear the console.</p>

<p>First, we’re going to separate the lines of the song based on whether it is being sung by the Captain or by the Sailors’ Chorus.  Press Enter at appropriate locations to separate lines when the singer changes.  The result should look like this:</p>

<p><img src="02_lesson_images/pinafore-line-split.png" alt="Pinafore lines split" /></p>

<p>Save and run this in the console.  The console will look like this:</p>

<p><img src="02_lesson_images/spaced-version-console.png" alt="console output" /></p>

<p>Note that despite having added empty lines in our code, the song is printed the same way that it was before.  When interpreting code, Lua ignores “whitespace,” which is to say stuff like extra spaces (you often still need one space), tabs, or empty lines.</p>

<p>What we’re actually interested in at the moment is leaving ourselves a note about who is singing the next line of the song.  We don’t want this information to be printed to the Console, so we’ll just try writing some notes on the empty lines:</p>

<p><img src="02_lesson_images/bad-comments-pinafore.png" alt="invalid code" /></p>

<p>Notice that the <strong>pinafore.lua</strong> file name is now coloured red.  This means that if we try to run the file, we’ll get an error.  The red underlining in the code (which would indicate misspelling in a word processor) tells us the part of code that will cause the error, and the red in the file overview and scroll bar on the right give that information in relation to the entire file.</p>

<p>For now, let’s save <strong>pinafore.lua</strong> anyway, and try to load the script in the console.</p>

<p>None of the song will be printed (although the last song will still be visible).  Instead, you will get the following message:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:\Games\Test of Time\lua\pinafore.lua:3: syntax error near 'print'
</code></pre></div></div>

<p>A “syntax error” means that the file has “instructions” that haven’t been written properly.  That is, the Lua interpreter can’t transform what we’ve written into instructions for the computer.</p>

<p>The <code class="language-plaintext highlighter-rouge">C:\Games\Test of Time\lua\pinafore.lua:3:</code> part of the error message tells us that the error was detected on line 3 of <strong>pinafore.lua</strong>, and the <code class="language-plaintext highlighter-rouge">near 'print'</code> gives a bit of extra information.  So, the Lua Console “realized” there was something wrong with the file just before the <code class="language-plaintext highlighter-rouge">print</code> command on line 3.  VS code identifies the problem as the <code class="language-plaintext highlighter-rouge">Captain</code> “code” on line 2.</p>

<p>Now, we weren’t trying to give the Lua Console an instruction called “Captain,” but rather trying to write a note for ourselves.  Lua has ways of indicating that part of the file are “comments” and should be ignored by the interpreter. The most basic way to do so is to add a double dash <code class="language-plaintext highlighter-rouge">--</code> to a line.  This tells the Lua interpreter to ignore everything on the line <em>after</em> that point.</p>

<p>Add <code class="language-plaintext highlighter-rouge">--</code> at the start of the lines with Captain and Sailors, and save.</p>

<p>Your file will look like this:</p>

<p><img src="02_lesson_images/pinafore-with-comments.png" alt="pinafore file with comments" /></p>

<p>Notice how the <code class="language-plaintext highlighter-rouge">--Captain</code> and <code class="language-plaintext highlighter-rouge">--Sailors</code> lines are now coloured green.  This is the way that VS Code indicates that a portion of code is a comment.  Of course, the colour might be different if you use a different highlighting scheme.</p>

<p>Load the script again, and the song will once more be printed, the comments totally ignored.</p>

<p><img src="02_lesson_images/console-after-comments.png" alt="pinafore printed after error" /></p>

<p>Comments do not have to literally be “comments” about our code.  If we want to stop part of our code from executing, we can “comment it out” by putting <code class="language-plaintext highlighter-rouge">--</code> before it.</p>

<p>Comment out line 5.  While you’re at it, add a comment to line 7, saying “maybe this line should go”, but make sure the script will still print “You’re very, very good,”.</p>

<p><img src="02_lesson_images/one-line-commented-out.png" alt="one line commented out" /></p>

<p>Since <code class="language-plaintext highlighter-rouge">--</code> only comments out stuff <em>after</em> it, “You’re very, very good,” is still printed.</p>

<p><img src="02_lesson_images/pinafore-missing-line-5.png" alt="song with missing line" /></p>

<p>If you want to comment out multiple lines at once, or comment out only part of a line, you can start the comment with <code class="language-plaintext highlighter-rouge">--[[</code> and end it with <code class="language-plaintext highlighter-rouge">]]</code>.</p>

<p>So, for example, we can comment out several lines, or put a note before a <code class="language-plaintext highlighter-rouge">print</code> command:</p>

<p><img src="02_lesson_images/multi-line-comment.png" alt="more pinafore comments" /></p>

<p>Comment out lines 7-13 as shown in the above image (lines 8-14 after the line is inserted to start a comment).  Also, add the comment <code class="language-plaintext highlighter-rouge">--[['never, ever' ?]]</code> as shown.  You will probably notice that when you type <code class="language-plaintext highlighter-rouge">--[[</code>, the <code class="language-plaintext highlighter-rouge">]]</code> is filled in automatically.  If you like, you can change this behaviour through the menu File&gt;Preferences&gt;Settings, which will open the Settings tab.</p>

<p>In the Settings tab, scroll down to the <strong>Text Editor</strong> section (the section right after <strong>Commonly Used</strong>) and change the <strong>Auto Closing Brackets</strong> setting.</p>

<p><img src="02_lesson_images/auto-closing-brackets-setting.png" alt="auto closing brackets" /></p>

<p>Once you’ve added the comments, run the script again.  Notice that many lines were skipped, but the line “And I’m never, never sick at sea!” is unchanged, despite the comment on that line.</p>

<p><img src="02_lesson_images/short-pinafore-song.png" alt="short pinafore" /></p>
<h2 id="conclusion">
  
  
    Conclusion <a href="#conclusion"><span class="self-link">&#128279</span></a>
  
  
</h2>
    

<p>In this lesson, we’ve installed a convenient program to write code in, seen how to write scripts, and also how to run them.  We’ve also learned how to add comments to our code, either as documentation or to prevent some code from running even if we don’t want to delete it outright.  In the next lesson, we’ll start performing calculations, rather than just printing a song to the console.</p>

<table>
  <tbody>
    <tr>
      <td>Previous: <a href="01_helloWorld.html">Hello World</a></td>
      <td>Next: <a href="03_valuesAndVariables.html">Values and Variables</a></td>
    </tr>
  </tbody>
</table>

  </div>
</article>
<!--
    <table>
  <tbody>
    <tr>
      <td>Previous: <a href="01_helloWorld.html">Hello World</a></td>
      <td>Next: <a href="03_valuesAndVariables.html">Values and Variables</a></td>
    </tr>
  </tbody>
</table>
<h1 id="writing-programs">
  
  
    <a href="#writing-programs">&#128279</a> Writing Programs
  
  
</h1>
    
<h2 id="introduction">
  
  
    <a href="#introduction">&#128279</a> Introduction
  
  
</h2>
    

<p>In <a href="01_helloWorld.html">Lesson 1</a>, we wrote code directly into the Lua Console, and it executed those commands immediately.  Usually, however, we will want to write our code ahead of time and run it all at once.  In this lesson, we will download the software to create and change Lua files, write some programs, and run them in the Lua Console.</p>
<h2 id="setting-up-our-programming-environment">
  
  
    <a href="#setting-up-our-programming-environment">&#128279</a> Setting Up Our Programming Environment
  
  
</h2>
    

<p>In order to write programs in Lua (or any programming language) you will need to use a special kind of program called a “text editor.”  This is NOT the same thing as a “word processor.”  A program like Libre Office Writer or Microsoft Word will not work for our purposes.  Lua programs are written in “plain text” format, which is to say that the file is just a sequence of letters, numbers, special characters, spaces, etc.  There is no extra data for stuff like formatting or fonts.</p>

<p>In plain text, an A is an A is an A.  But in a Word document, you could have an A or an <em>A</em> or an <strong>A</strong> or an <span style="font-size:30px">A</span>.  That extra information doesn’t exist in a plain text file.  The rules.txt, game.txt, and events.txt files are all examples of text files.  A text editor is a program designed for writing and changing text files, and provides features useful for programming such as different colors for different programming elements.</p>

<p>Some text editors have a lot of features useful for programmers, and are called “Integrated Development Environments,” or IDEs.  For these lessons, I will be using <a href="https://code.visualstudio.com/">Visual Studio Code</a>, which is an IDE, but I would recommend also installing <a href="https://notepad-plus-plus.org/">notepad++</a> or some other more “lightweight” text editor for when you just want to take a look at an individual file.</p>

<p>Download and install Visual Studio Code (VS Code).  Default installation choices are probably fine, except that during Select Additional Tasks, you should probably enable all the “other” options:</p>

<p><img src="02_lesson_images/install-additional-tasks.png" alt="additional tasks" /></p>

<p>The first time you open Visual Studio Code, it will probably look something like this:</p>

<p><img src="02_lesson_images/vs-code-first-image.png" alt="First VS Code Screen" /></p>

<p>You should choose a theme here.  I will be using Dark Modern for these lessons, so, you should do the same if you want syntax colours to match what I’m using.  Note that VS Code prints unused code in a slightly lighter shade.  This is a fine feature (it alerts you to code you might want to delete), but it often applies to the code you are currently writing, and you might find that a light theme doesn’t contrast enough with the code.  That is why I chose a dark theme.</p>

<p>You can always change your theme, by selecting this menu sequence:</p>

<p><img src="02_lesson_images/theme-change-menu.png" alt="Menu choices to change theme" /></p>

<p>We don’t have to worry about any of the other stuff in the welcome window for now.  Instead, we will install the <a href="https://github.com/LuaLS/lua-language-server#lua-language-server">Lua Language Server</a> Extension, by sumneko.</p>

<p>Click on the extensions icon <img src="02_lesson_images/extensions-icon.png" alt="extensions icon" /> and search for Lua Language Server.  Make sure that sumneko is the author, so you get the correct one.</p>

<p><img src="02_lesson_images/lua-ls-extension.png" alt="Lua Language Server Installation" /></p>
<h2 id="writing-a-script">
  
  
    <a href="#writing-a-script">&#128279</a> Writing a Script
  
  
</h2>
    

<p>Now, we will write a “script,” which is just another way of saying program.  In VS Code, select Open Folder from the drop down File menu</p>

<p><img src="02_lesson_images/open-folder.png" alt="Open Folder" /></p>

<p>And navigate to and select the <strong>lua</strong> folder within your <strong>Test of Time</strong> directory.  (You may not see any files within the directory in the navigation window.)  You may be asked if you trust the files in the folder.  Say that you do.</p>

<p>This folder will already contain a few files.  We won’t be using any of them.  Instead, create a new text file.  You can right click within the file explorer, (which you can open with the <img src="02_lesson_images/explore-icon.png" alt="file explorer icon" /> button), or use the new file button (you will have to hover your mouse there for the icons to appear):</p>

<p><img src="02_lesson_images/new-file.png" alt="New File Button" /></p>

<p>Name the file <strong>pinafore.lua</strong>.  Your VS Code window will now look something like this:</p>

<p><img src="02_lesson_images/ready-to-work.png" alt="Ready to Work" /></p>

<p>You might have noticed that the other .lua files are now highlighted in yellow.  This is because the Lua Language Server has detected potential mistakes in those files.  If a file is known <em>for sure</em> to have an error, it will be highlighted in red.  Don’t worry about the other files.</p>

<p>Copy the following code into <strong>pinafore.lua</strong> (although I suggest you usually type the code in yourself, in this case you might as well copy and paste most of it):</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">print</span><span class="p">(</span><span class="s2">"I am the Captain of the Pinafore;"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"And a right good captain, too!"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"You're very, very good,"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"And be it understood,"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"I command a right good crew."</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"We're very, very good,"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"And be it understood,"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"He commands a right good crew."</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Though related to a peer,"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"I can hand, reef, and steer,"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"And ship a selvagee;"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"I am never known to quail"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"At the fury of a gale,"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"And I'm never, never sick at sea!"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"What, never?"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"No, never!"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"What, never?"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Hardly ever!"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"He's hardly ever sick at sea!"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Then give three cheers, and one cheer more,"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"For the hardy Captain of the Pinafore!"</span><span class="p">)</span>
</code></pre></div></div>
<p>(<a href="https://www.youtube.com/watch?v=c548RjB8jzQ">This song</a> is from the Gilbert and Sullivan play H.M.S. Pinafore)</p>

<p>If you start to type out the above code, Visual Studio Code will start offering suggestions in a suggestion box, like this:</p>

<p><img src="02_lesson_images/suggestion-while-typing.png" alt="suggestion box" /></p>

<p>Ignore the suggestions and information in these boxes for now.  Eventually, they will be helpful.</p>

<p>Once you’ve copied the code, you should notice a few things about VS Code.</p>

<ol>
  <li>The file explorer icon has a circle with a 1 in it.  This means there is one unsaved file.</li>
  <li>The tab for <strong>pinafore.lua</strong> also has a circle, instead of an x. This means that <strong>pinafore.lua</strong> is unsaved.</li>
  <li>Each line in the editor has a number beside it, to tell you what line of the file it is.</li>
</ol>

<p><img src="02_lesson_images/unsaved-pinafore.png" alt="Pinafore.lua is unsaved" /></p>

<p>Under the File menu, choose Save All.</p>

<p>Now, start a new Original game and open the Lua Console (just as we did in Lesson 1).  Press the Load Script button in the bottom right, navigate to the <strong>Test of Time\lua</strong> folder, and choose <strong>pinafore.lua</strong>.  Note: Depending on your settings, Windows might hide the .lua extension, but the “Type” will be “Lua Source File.”</p>

<p><img src="02_lesson_images/load-script.png" alt="Load Script" /></p>

<p><img src="02_lesson_images/open-pinafore.png" alt="Open Pinafore.lua" /></p>

<p>All the print commands are immediately executed, in order, and the song is printed to the console:</p>

<p><img src="02_lesson_images/pinafore-print-1.png" alt="I am the captain of the pinafore" /></p>

<p>Note that Lua (or any programming language) will blindly follow your instructions, regardless of what makes sense.  For example, if we swap lines 1 and 3 in <strong>pinafore.lua</strong>, save, and run the script again with Load Script, the Lua Console will happily print our song, even though it makes no sense to us:</p>

<p><img src="02_lesson_images/mixed-up-song.png" alt="Lines 3 and 1 swapped" /></p>

<p><img src="02_lesson_images/print-mixed-up-song.png" alt="Printed Mixed Up Song" /></p>

<p>In addition to printing a nonsensical start to the song, the Lua Console didn’t even split the last line of the first rendition from the first line of the second rendition.  Why not?  We didn’t tell it to, so it had no way of knowing that it would be a good idea to do that.</p>

<p>It probably makes sense to have an empty line at the start and end of this script.  We will do this in two different ways.  Change the print statements back to their original order, then insert this line as a new first line:</p>
<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
</code></pre></div></div>
<p>This will print an empty line before the song starts.  At the end, we’ll do something a bit different.  Change the last line (formerly line 21, now line 22) to</p>
<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">print</span><span class="p">(</span><span class="s2">"For the hardy Captain of the Pinafore!\n"</span><span class="p">)</span>
</code></pre></div></div>
<p>Up to this point, the <code class="language-plaintext highlighter-rouge">print</code> command has printed every character between <code class="language-plaintext highlighter-rouge">"</code> marks to the console, just as we wrote it.  However, the <code class="language-plaintext highlighter-rouge">\</code> indicates that it and the next character should be interpreted as a single character.  In this case, <code class="language-plaintext highlighter-rouge">\n</code> represents the “newline” character, which tells the Lua Console to move to the next line.</p>

<p><strong>pinafore.lua</strong> will now look like this:</p>

<p><img src="02_lesson_images/pinafore-with-newlines.png" alt="pinafore.lua with spaces" /></p>

<p>Save and load the <strong>pinafore.lua</strong> script a couple more times.  The first time, you will see 1 empty line between the end of the previous rendition, and the start of the next one.  The second time, you will see two empty lines, one of which was created at the end of a rendition, and the next created at the start of one.</p>

<p><img src="02_lesson_images/pinafore-single-double.png" alt="pinafore rendition spacing" /></p>
<h2 id="adding-comments-in-code">
  
  
    <a href="#adding-comments-in-code">&#128279</a> Adding Comments in Code
  
  
</h2>
    

<p>So far, the Lua Console has done something with every character written in <strong>pinafore.lua</strong>.  The command <code class="language-plaintext highlighter-rouge">print</code> along with <code class="language-plaintext highlighter-rouge">("</code> and <code class="language-plaintext highlighter-rouge">")</code> has told Lua that we want stuff printed to the console window, and the characters between the <code class="language-plaintext highlighter-rouge">"</code> marks were actually printed.  In this section, we will write “comments” in our code, which Lua will ignore.</p>

<p>Save your game, and then load it again.  This will clear the console.</p>

<p>First, we’re going to separate the lines of the song based on whether it is being sung by the Captain or by the Sailors’ Chorus.  Press Enter at appropriate locations to separate lines when the singer changes.  The result should look like this:</p>

<p><img src="02_lesson_images/pinafore-line-split.png" alt="Pinafore lines split" /></p>

<p>Save and run this in the console.  The console will look like this:</p>

<p><img src="02_lesson_images/spaced-version-console.png" alt="console output" /></p>

<p>Note that despite having added empty lines in our code, the song is printed the same way that it was before.  When interpreting code, Lua ignores “whitespace,” which is to say stuff like extra spaces (you often still need one space), tabs, or empty lines.</p>

<p>What we’re actually interested in at the moment is leaving ourselves a note about who is singing the next line of the song.  We don’t want this information to be printed to the Console, so we’ll just try writing some notes on the empty lines:</p>

<p><img src="02_lesson_images/bad-comments-pinafore.png" alt="invalid code" /></p>

<p>Notice that the <strong>pinafore.lua</strong> file name is now coloured red.  This means that if we try to run the file, we’ll get an error.  The red underlining in the code (which would indicate misspelling in a word processor) tells us the part of code that will cause the error, and the red in the file overview and scroll bar on the right give that information in relation to the entire file.</p>

<p>For now, let’s save <strong>pinafore.lua</strong> anyway, and try to load the script in the console.</p>

<p>None of the song will be printed (although the last song will still be visible).  Instead, you will get the following message:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:\Games\Test of Time\lua\pinafore.lua:3: syntax error near 'print'
</code></pre></div></div>

<p>A “syntax error” means that the file has “instructions” that haven’t been written properly.  That is, the Lua interpreter can’t transform what we’ve written into instructions for the computer.</p>

<p>The <code class="language-plaintext highlighter-rouge">C:\Games\Test of Time\lua\pinafore.lua:3:</code> part of the error message tells us that the error was detected on line 3 of <strong>pinafore.lua</strong>, and the <code class="language-plaintext highlighter-rouge">near 'print'</code> gives a bit of extra information.  So, the Lua Console “realized” there was something wrong with the file just before the <code class="language-plaintext highlighter-rouge">print</code> command on line 3.  VS code identifies the problem as the <code class="language-plaintext highlighter-rouge">Captain</code> “code” on line 2.</p>

<p>Now, we weren’t trying to give the Lua Console an instruction called “Captain,” but rather trying to write a note for ourselves.  Lua has ways of indicating that part of the file are “comments” and should be ignored by the interpreter. The most basic way to do so is to add a double dash <code class="language-plaintext highlighter-rouge">--</code> to a line.  This tells the Lua interpreter to ignore everything on the line <em>after</em> that point.</p>

<p>Add <code class="language-plaintext highlighter-rouge">--</code> at the start of the lines with Captain and Sailors, and save.</p>

<p>Your file will look like this:</p>

<p><img src="02_lesson_images/pinafore-with-comments.png" alt="pinafore file with comments" /></p>

<p>Notice how the <code class="language-plaintext highlighter-rouge">--Captain</code> and <code class="language-plaintext highlighter-rouge">--Sailors</code> lines are now coloured green.  This is the way that VS Code indicates that a portion of code is a comment.  Of course, the colour might be different if you use a different highlighting scheme.</p>

<p>Load the script again, and the song will once more be printed, the comments totally ignored.</p>

<p><img src="02_lesson_images/console-after-comments.png" alt="pinafore printed after error" /></p>

<p>Comments do not have to literally be “comments” about our code.  If we want to stop part of our code from executing, we can “comment it out” by putting <code class="language-plaintext highlighter-rouge">--</code> before it.</p>

<p>Comment out line 5.  While you’re at it, add a comment to line 7, saying “maybe this line should go”, but make sure the script will still print “You’re very, very good,”.</p>

<p><img src="02_lesson_images/one-line-commented-out.png" alt="one line commented out" /></p>

<p>Since <code class="language-plaintext highlighter-rouge">--</code> only comments out stuff <em>after</em> it, “You’re very, very good,” is still printed.</p>

<p><img src="02_lesson_images/pinafore-missing-line-5.png" alt="song with missing line" /></p>

<p>If you want to comment out multiple lines at once, or comment out only part of a line, you can start the comment with <code class="language-plaintext highlighter-rouge">--[[</code> and end it with <code class="language-plaintext highlighter-rouge">]]</code>.</p>

<p>So, for example, we can comment out several lines, or put a note before a <code class="language-plaintext highlighter-rouge">print</code> command:</p>

<p><img src="02_lesson_images/multi-line-comment.png" alt="more pinafore comments" /></p>

<p>Comment out lines 7-13 as shown in the above image (lines 8-14 after the line is inserted to start a comment).  Also, add the comment <code class="language-plaintext highlighter-rouge">--[['never, ever' ?]]</code> as shown.  You will probably notice that when you type <code class="language-plaintext highlighter-rouge">--[[</code>, the <code class="language-plaintext highlighter-rouge">]]</code> is filled in automatically.  If you like, you can change this behaviour through the menu File&gt;Preferences&gt;Settings, which will open the Settings tab.</p>

<p>In the Settings tab, scroll down to the <strong>Text Editor</strong> section (the section right after <strong>Commonly Used</strong>) and change the <strong>Auto Closing Brackets</strong> setting.</p>

<p><img src="02_lesson_images/auto-closing-brackets-setting.png" alt="auto closing brackets" /></p>

<p>Once you’ve added the comments, run the script again.  Notice that many lines were skipped, but the line “And I’m never, never sick at sea!” is unchanged, despite the comment on that line.</p>

<p><img src="02_lesson_images/short-pinafore-song.png" alt="short pinafore" /></p>
<h2 id="conclusion">
  
  
    <a href="#conclusion">&#128279</a> Conclusion
  
  
</h2>
    

<p>In this lesson, we’ve installed a convenient program to write code in, seen how to write scripts, and also how to run them.  We’ve also learned how to add comments to our code, either as documentation or to prevent some code from running even if we don’t want to delete it outright.  In the next lesson, we’ll start performing calculations, rather than just printing a song to the console.</p>

<table>
  <tbody>
    <tr>
      <td>Previous: <a href="01_helloWorld.html">Hello World</a></td>
      <td>Next: <a href="03_valuesAndVariables.html">Values and Variables</a></td>
    </tr>
  </tbody>
</table>
 -->
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
<!--        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
-->
<!--
-->
      </div>
      <div class="footer-col">
        <p>Reference materials and lessons for using Lua to program events for Civilization II: Test of Time</p>
      </div>
    </div>

    <div class="social-links">
<ul class="social-media-list">
  <li><a rel="me" href="https://github.com/ProfGarfield" target="_blank" title="ProfGarfield"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg>ProfGarfield</a></li>
  <li><a rel="me" href="https://www.youtube.com/user/ProfCiv2" target="_blank" title="YouTube"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#youtube"></use></svg>ProfCiv2</a></li>
  <li><a rel="me" href="https://forums.civfanatics.com/members/prof-garfield.43783/" target="_blank" title="Civfanatics Profile"><img src="/assets/civfanatics_icon.png" class="svg-icon grey"></img>Prof. Garfield</a></li>
</ul>
</div>

  </div>

</footer>
</body>

</html>

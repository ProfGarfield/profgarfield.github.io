<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/assets/css/style.css">
  <!--<link rel="icon" type="image/png" href="/assets/civfanatics_icon.png">-->
</head>
<body><header class="site-header">
  <div class="wrapper">
    <!--img src="/assets/logo-cfc.png" class="center"--><a class="site-title" rel="author" href="/">Lua for Civilization II</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/auto_doc/autoIndex.html">Function Docs</a><a class="page-link" href="/executionPoints.html">Execution Points</a><a class="page-link" href="/lua_lessons/lessons_toc.html">Lua Lessons</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <head><title>civ Library Documentation</title>
</head>
<article class="post">

  <header class="post-header">
    <h1 class="post-title">Civ Library</h1>
  </header>
  
  <div class="toc-div">
    <h2 class="toc-header">Contents</h2>
    <ul><li><a href="#civ-1">civ</a><ul><li><a href="#addimprovement">addImprovement</a></li><li><a href="#canenter">canEnter</a></li><li><a href="#capturecity">captureCity</a></li><li><a href="#createcity">createCity</a></li><li><a href="#createunit">createUnit</a></li><li><a href="#deletecity">deleteCity</a></li><li><a href="#deleteunit">deleteUnit</a></li><li><a href="#destroywonder">destroyWonder</a></li><li><a href="#enabletechgroup">enableTechGroup</a></li><li><a href="#endgame">endGame</a></li><li><a href="#getactiveunit">getActiveUnit</a></li><li><a href="#getatlasdimensions">getAtlasDimensions</a></li><li><a href="#getbaseterrain">getBaseTerrain</a></li><li><a href="#getcity">getCity</a></li><li><a href="#getcommodity">getCommodity</a></li><li><a href="#getcurrenttile">getCurrentTile</a></li><li><a href="#getcurrenttribe">getCurrentTribe</a></li><li><a href="#getgameyear">getGameYear</a></li><li><a href="#getimprovement">getImprovement</a></li><li><a href="#getmap">getMap</a></li><li><a href="#getmapdimensions">getMapDimensions</a></li><li><a href="#getopencity">getOpenCity</a></li><li><a href="#getplayertribe">getPlayerTribe</a></li><li><a href="#gettech">getTech</a></li><li><a href="#getterrain">getTerrain</a></li><li><a href="#gettile">getTile</a></li><li><a href="#gettotdir">getToTDir</a></li><li><a href="#gettribe">getTribe</a></li><li><a href="#getturn">getTurn</a></li><li><a href="#getunit">getUnit</a></li><li><a href="#getunittype">getUnitType</a></li><li><a href="#getwonder">getWonder</a></li><li><a href="#givetech">giveTech</a></li><li><a href="#hasimprovement">hasImprovement</a></li><li><a href="#hastech">hasTech</a></li><li><a href="#isbaseterrain">isBaseTerrain</a></li><li><a href="#iscity">isCity</a></li><li><a href="#isdialog">isDialog</a></li><li><a href="#isimage">isImage</a></li><li><a href="#isimprovement">isImprovement</a></li><li><a href="#isleader">isLeader</a></li><li><a href="#ismap">isMap</a></li><li><a href="#istech">isTech</a></li><li><a href="#isterrain">isTerrain</a></li><li><a href="#istile">isTile</a></li><li><a href="#istraderoute">isTradeRoute</a></li><li><a href="#istribe">isTribe</a></li><li><a href="#isunit">isUnit</a></li><li><a href="#isunittype">isUnitType</a></li><li><a href="#iswonder">isWonder</a></li><li><a href="#iteratecities">iterateCities</a></li><li><a href="#iterateunits">iterateUnits</a></li><li><a href="#killtribe">killTribe</a></li><li><a href="#makeaggression">makeAggression</a></li><li><a href="#playmusic">playMusic</a></li><li><a href="#playsound">playSound</a></li><li><a href="#playvideo">playVideo</a></li><li><a href="#removeimprovement">removeImprovement</a></li><li><a href="#sleep">sleep</a></li><li><a href="#taketech">takeTech</a></li><li><a href="#teleportunit">teleportUnit</a></li></ul></li><li><a href="#civui">civ.ui</a><ul><li><a href="#centerview">centerView</a></li><li><a href="#createdialog">createDialog</a></li><li><a href="#loadimage">loadImage</a></li><li><a href="#loadterrain">loadTerrain</a></li><li><a href="#redrawmap">redrawMap</a></li><li><a href="#redrawtile">redrawTile</a></li><li><a href="#setzoom">setZoom</a></li><li><a href="#text">text</a></li><li><a href="#zoomin">zoomIn</a></li><li><a href="#zoomout">zoomOut</a></li></ul></li><li><a href="#civcosmic">civ.cosmic</a><ul><li><a href="#communismpalacedistance">communismPalaceDistance</a></li><li><a href="#foodeaten">foodEaten</a></li><li><a href="#foodrows">foodRows</a></li><li><a href="#goodiehutsmask">goodieHutsMask</a></li><li><a href="#helispickuphuts">helisPickupHuts</a></li><li><a href="#massthrustparadigm">massThrustParadigm</a></li><li><a href="#numberofunittypes">numberOfUnitTypes</a></li><li><a href="#paradroprange">paradropRange</a></li><li><a href="#penaltybetrayal">penaltyBetrayal</a></li><li><a href="#prodchangepenalty">prodChangePenalty</a></li><li><a href="#riotfactor">riotFactor</a></li><li><a href="#roadmultiplier">roadMultiplier</a></li><li><a href="#sciencelostfundamentalism">scienceLostFundamentalism</a></li><li><a href="#scienceratefundamentalism">scienceRateFundamentalism</a></li><li><a href="#scorecentauri">scoreCentauri</a></li><li><a href="#scorecitizen">scoreCitizen</a></li><li><a href="#scorefuturetech">scoreFutureTech</a></li><li><a href="#scorepeace">scorePeace</a></li><li><a href="#scorepollution">scorePollution</a></li><li><a href="#scoreunitkilled">scoreUnitKilled</a></li><li><a href="#scorewonder">scoreWonder</a></li><li><a href="#settlerseathigh">settlersEatHigh</a></li><li><a href="#settlerseatlow">settlersEatLow</a></li><li><a href="#shieldrows">shieldRows</a></li><li><a href="#sizeaquaduct">sizeAquaduct</a></li><li><a href="#sizesewer">sizeSewer</a></li><li><a href="#sizeunhappiness">sizeUnhappiness</a></li><li><a href="#supportcommunism">supportCommunism</a></li><li><a href="#supportfundamentalism">supportFundamentalism</a></li><li><a href="#supportmonarchy">supportMonarchy</a></li><li><a href="#techparadigm">techParadigm</a></li><li><a href="#transformbase">transformBase</a></li><li><a href="#triremelost">triremeLost</a></li></ul></li><li><a href="#civgame">civ.game</a><ul><li><a href="#activetribes">activeTribes</a></li><li><a href="#barbarianactivity">barbarianActivity</a></li><li><a href="#difficulty">difficulty</a></li><li><a href="#gameyear">gameYear</a></li><li><a href="#humanplayers">humanPlayers</a></li><li><a href="#humantribe">humanTribe</a></li><li><a href="#peaceturns">peaceTurns</a></li><li><a href="#revealmap">revealMap</a></li><li><a href="#turnselapsed">turnsElapsed</a></li></ul></li><li><a href="#civgamerules">civ.game.rules</a><ul><li><a href="#flatworld">flatWorld</a></li></ul></li><li><a href="#civscenparams">civ.scen.params</a><ul><li><a href="#decisivedefeat">decisiveDefeat</a></li><li><a href="#decisivevictory">decisiveVictory</a></li><li><a href="#flags">flags</a></li><li><a href="#marginaldefeat">marginalDefeat</a></li><li><a href="#marginalvictory">marginalVictory</a></li><li><a href="#maxturns">maxTurns</a></li><li><a href="#name">name</a></li><li><a href="#objectivesprotagonist">objectivesProtagonist</a></li><li><a href="#startingyear">startingYear</a></li><li><a href="#techparadigm-1">techParadigm</a></li><li><a href="#yearincrement">yearIncrement</a></li></ul></li><li><a href="#civscencompatibility">civ.scen.compatibility</a><ul><li><a href="#activateuniteverymove">activateUnitEveryMove</a></li></ul></li><li><a href="#civscen">civ.scen</a><ul><li><a href="#onactivateunit">onActivateUnit</a></li><li><a href="#onbribeunit">onBribeUnit</a></li><li><a href="#oncalculatecityyield">onCalculateCityYield</a></li><li><a href="#oncanbuild">onCanBuild</a></li><li><a href="#oncanfoundcity">onCanFoundCity</a></li><li><a href="#oncentauriarrival">onCentauriArrival</a></li><li><a href="#onchoosedefender">onChooseDefender</a></li><li><a href="#oncitydestroyed">onCityDestroyed</a></li><li><a href="#oncityfounded">onCityFounded</a></li><li><a href="#oncityprocessingcomplete">onCityProcessingComplete</a></li><li><a href="#oncityproduction">onCityProduction</a></li><li><a href="#oncitytaken">onCityTaken</a></li><li><a href="#ongameends">onGameEnds</a></li><li><a href="#ongetformatteddate">onGetFormattedDate</a></li><li><a href="#ongetrushbuycost">onGetRushBuyCost</a></li><li><a href="#oninitiatecombat">onInitiateCombat</a></li><li><a href="#onkeypress">onKeyPress</a></li><li><a href="#onload">onLoad</a></li><li><a href="#onnegotiation">onNegotiation</a></li><li><a href="#onresolvecombat">onResolveCombat</a></li><li><a href="#onsave">onSave</a></li><li><a href="#onscenarioloaded">onScenarioLoaded</a></li><li><a href="#onschism">onSchism</a></li><li><a href="#onselectmusic">onSelectMusic</a></li><li><a href="#ontribeturnbegin">onTribeTurnBegin</a></li><li><a href="#ontribeturnend">onTribeTurnEnd</a></li><li><a href="#onturn">onTurn</a></li><li><a href="#onunitkilled">onUnitKilled</a></li><li><a href="#onusenuclearweapon">onUseNuclearWeapon</a></li></ul></li></ul></div>  
  
  <div class="post-content">
    <h1 id="civ">
  
  
    civ <a href="#civ"><span class="self-link">&#128279</span></a>
  
  
</h1>
    

<p>The civ module provides functions which can interact directly with the game.  It is always in scope, so you never need to use a <code class="language-plaintext highlighter-rouge">require</code> call in order to access it.</p>
<h2 id="civ-1">
  
  
    civ <a href="#civ-1"><span class="self-link">&#128279</span></a>
  
  
</h2>
    
<h3 id="addimprovement">
  
  
    addImprovement <a href="#addimprovement"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.addImprovement(city: cityObject, improvement: improvementObject)
</code></pre></div></div>
<p>Adds city improvement <code class="language-plaintext highlighter-rouge">improvement</code> to city <code class="language-plaintext highlighter-rouge">city</code>.</p>
<h3 id="canenter">
  
  
    canEnter <a href="#canenter"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.canEnter(unitType: unitTypeObject, tile: tileObject)
  -&gt; boolean: boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if the given unittype can enter tile <code class="language-plaintext highlighter-rouge">tile</code>, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>
<h3 id="capturecity">
  
  
    captureCity <a href="#capturecity"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.captureCity(city: cityObject, tribe: tribeObject)
</code></pre></div></div>
<p>Captures city <code class="language-plaintext highlighter-rouge">city</code> for tribe <code class="language-plaintext highlighter-rouge">tribe</code>.</p>
<h3 id="createcity">
  
  
    createCity <a href="#createcity"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.createCity(tribe: tribeObject, tile: tileObject)
  -&gt; city: cityObject|nil
</code></pre></div></div>
<p>Creates a city owned by <code class="language-plaintext highlighter-rouge">tribe</code> at the location given by <code class="language-plaintext highlighter-rouge">tile</code>. Returns <code class="language-plaintext highlighter-rouge">nil</code> if a city could not be created.</p>
<h3 id="createunit">
  
  
    createUnit <a href="#createunit"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.createUnit(unitType: unitTypeObject, tribe: tribeObject, tile: tileObject)
  -&gt; unit: unitObject
</code></pre></div></div>
<p>Creates a unit of type <code class="language-plaintext highlighter-rouge">unittype</code>, owned by <code class="language-plaintext highlighter-rouge">tribe</code>, at the location given by <code class="language-plaintext highlighter-rouge">tile</code>.</p>
<h3 id="deletecity">
  
  
    deleteCity <a href="#deletecity"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.deleteCity(city: cityObject)
</code></pre></div></div>
<p>Deletes city <code class="language-plaintext highlighter-rouge">city</code> from the game.</p>
<h3 id="deleteunit">
  
  
    deleteUnit <a href="#deleteunit"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.deleteUnit(unit: unitObject)
</code></pre></div></div>
<p>Deletes unit <code class="language-plaintext highlighter-rouge">unit</code> from the game.
Consider unsing <code class="language-plaintext highlighter-rouge">gen.defeatUnit</code>, <code class="language-plaintext highlighter-rouge">gen.killUnit</code>, <code class="language-plaintext highlighter-rouge">gen.deleteUnit</code>, or <code class="language-plaintext highlighter-rouge">gen.replaceUnit</code> instead, for event integration.
<br />Deprecation flag is only here so that designers see the above notice.</p>
<h3 id="destroywonder">
  
  
    destroyWonder <a href="#destroywonder"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.destroyWonder(wonder: wonderObject)
</code></pre></div></div>
<p>Destroys wonder <code class="language-plaintext highlighter-rouge">wonder</code>, removing it from the game, and marking it as ‘lost’.</p>
<h3 id="enabletechgroup">
  
  
    enableTechGroup <a href="#enabletechgroup"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.enableTechGroup(tribe: tribeObject, techgroup: integer, value: 0|1|2)
</code></pre></div></div>
<p>Sets the value of tech group <code class="language-plaintext highlighter-rouge">techgroup</code> (0-7) to value <code class="language-plaintext highlighter-rouge">value</code> (0-2, 0 = can research, can own, 1 = can’t research, can own, 2 = can’t research, can’t own) for tribe <code class="language-plaintext highlighter-rouge">tribe</code>.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">techgroup</code> — integer in [0,7]</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">value</span><span class="p">:</span>
    <span class="err">\|</span> <span class="mi">0</span> <span class="c1">-- can research, can own</span>
    <span class="err">\|</span> <span class="mi">1</span> <span class="c1">-- can't research, can own</span>
    <span class="err">\|</span> <span class="mi">2</span> <span class="c1">-- can't research, can't own</span>
</code></pre></div></div>
<h3 id="endgame">
  
  
    endGame <a href="#endgame"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.endGame(endscreens: boolean)
</code></pre></div></div>
<p>Ends the game. <code class="language-plaintext highlighter-rouge">endscreens</code> is a boolean that determines whether to show the powergraph and related screens.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">endscreens</code> — This argument is false by default.</p>
<h3 id="getactiveunit">
  
  
    getActiveUnit <a href="#getactiveunit"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getActiveUnit()
  -&gt; unit: unitObject
</code></pre></div></div>
<p>Returns the currently active unit.</p>
<h3 id="getatlasdimensions">
  
  
    getAtlasDimensions <a href="#getatlasdimensions"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getAtlasDimensions()
  -&gt; width: integer
  2. height: integer
  3. number_of_maps: integer
</code></pre></div></div>
<p>Returns three integers, the width and height of the map and the number of maps.</p>
<h3 id="getbaseterrain">
  
  
    getBaseTerrain <a href="#getbaseterrain"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getBaseTerrain(map: integer|mapObject, terrainId: integer)
  -&gt; baseTerrain: baseTerrainObject
</code></pre></div></div>
<p>Returns the base terrain object for the given map and terrain type.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">map</code> — The map for the base terrain type we want, or its id.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">terrainId</code> — The id number of the base terrain type sought</p>
<h3 id="getcity">
  
  
    getCity <a href="#getcity"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getCity(id: integer)
  -&gt; city: cityObject|nil
</code></pre></div></div>
<p>Returns the city with id <code class="language-plaintext highlighter-rouge">id</code>, or <code class="language-plaintext highlighter-rouge">nil</code> if it doesn’t exist.</p>
<h3 id="getcommodity">
  
  
    getCommodity <a href="#getcommodity"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getCommodity(id: integer)
  -&gt; commodity: commodityObject|nil
</code></pre></div></div>
<p>Returns the commodity with id <code class="language-plaintext highlighter-rouge">id</code> (0-15 for regular commodities, -1 for food supplies), or <code class="language-plaintext highlighter-rouge">nil</code> if it doesn’t exist.</p>
<h3 id="getcurrenttile">
  
  
    getCurrentTile <a href="#getcurrenttile"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getCurrentTile()
  -&gt; tile: tileObject
</code></pre></div></div>
<p>Returns the currently selected tile.</p>
<h3 id="getcurrenttribe">
  
  
    getCurrentTribe <a href="#getcurrenttribe"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getCurrentTribe()
  -&gt; tribe: tribeObject
</code></pre></div></div>
<p>Returns the currently active tribe.</p>
<h3 id="getgameyear">
  
  
    getGameYear <a href="#getgameyear"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getGameYear()
  -&gt; integer: integer
</code></pre></div></div>
<p>Returns the current game year.</p>
<h3 id="getimprovement">
  
  
    getImprovement <a href="#getimprovement"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getImprovement(id: integer)
  -&gt; improvement: improvementObject|nil
</code></pre></div></div>
<p>Returns the improvement with id <code class="language-plaintext highlighter-rouge">id</code> (0-39), or <code class="language-plaintext highlighter-rouge">nil</code> if it doesn’t exist.</p>
<h3 id="getmap">
  
  
    getMap <a href="#getmap"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getMap(id: integer)
  -&gt; map: mapObject|nil
</code></pre></div></div>
<p>Returns the map with id <code class="language-plaintext highlighter-rouge">id</code> (0-3) or <code class="language-plaintext highlighter-rouge">nil</code> if it doesn’t exist.</p>
<h3 id="getmapdimensions">
  
  
    getMapDimensions <a href="#getmapdimensions"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getMapDimensions()
  -&gt; width: integer
  2. height: integer
  3. number_of_maps: integer
</code></pre></div></div>
<p>Alias for getAtlasDimensions. (deprecated since 0.16)</p>
<h3 id="getopencity">
  
  
    getOpenCity <a href="#getopencity"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getOpenCity()
  -&gt; city: cityObject|nil
</code></pre></div></div>
<p>Returns the city currently opened in the city window, <code class="language-plaintext highlighter-rouge">nil</code> if the city window is closed.</p>
<h3 id="getplayertribe">
  
  
    getPlayerTribe <a href="#getplayertribe"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getPlayerTribe()
  -&gt; tribe: tribeObject
</code></pre></div></div>
<p>Returns the player’s tribe.</p>
<h3 id="gettech">
  
  
    getTech <a href="#gettech"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getTech(id: integer)
  -&gt; tech: techObject|nil
</code></pre></div></div>
<p>Returns the tech with id <code class="language-plaintext highlighter-rouge">id</code> (0-99), or <code class="language-plaintext highlighter-rouge">nil</code> if it doesn’t exist.</p>
<h3 id="getterrain">
  
  
    getTerrain <a href="#getterrain"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getTerrain(map: integer|mapObject, terrainId: integer, resource: 0|1|2)
  -&gt; terrain: terrainObject
</code></pre></div></div>
<p>Returns the terrain object for the given map, terrain type and resource. Out of bound id’s cause errors.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">map</code> — The map for the terrain we want, or its id.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">terrainId</code> — The id number of the base terrain type sought.</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resource</span><span class="p">:</span>
    <span class="err">\|</span> <span class="mi">0</span> <span class="c1">-- no resource</span>
    <span class="err">\|</span> <span class="mi">1</span> <span class="c1">-- fish resource</span>
    <span class="err">\|</span> <span class="mi">2</span> <span class="c1">-- whales resource</span>
</code></pre></div></div>
<h3 id="gettile">
  
  
    getTile <a href="#gettile"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getTile(x: integer, y: integer, z: integer)
  -&gt; tile: tileObject|nil
</code></pre></div></div>
<p>Returns the tile with coordinates <code class="language-plaintext highlighter-rouge">x</code>, <code class="language-plaintext highlighter-rouge">y</code>, <code class="language-plaintext highlighter-rouge">z</code>, or <code class="language-plaintext highlighter-rouge">nil</code> if it doesn’t exist.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">x</code> — the ‘x’ coordinate of the tile</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">y</code> — the ‘y’ coordinate of the tile</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">z</code> — the ‘z’ coordinate of the tile ([0,3])</p>
<h3 id="gettotdir">
  
  
    getToTDir <a href="#gettotdir"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getToTDir()
  -&gt; string
</code></pre></div></div>
<p>Returns the absolute path of the ToT installation directory.</p>

<p>@<em>return</em> —</p>
<h3 id="gettribe">
  
  
    getTribe <a href="#gettribe"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getTribe(id: integer)
  -&gt; tribe: tribeObject|nil
</code></pre></div></div>
<p>Returns the tribe with id <code class="language-plaintext highlighter-rouge">id</code> (0-7), or <code class="language-plaintext highlighter-rouge">nil</code> if it doesn’t exist.</p>
<h3 id="getturn">
  
  
    getTurn <a href="#getturn"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getTurn()
  -&gt; integer
</code></pre></div></div>
<p>Returns the current turn number.</p>

<p>@<em>return</em> —</p>
<h3 id="getunit">
  
  
    getUnit <a href="#getunit"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getUnit(id: integer)
  -&gt; unit: unitObject|nil
</code></pre></div></div>
<p>Returns the unit with id <code class="language-plaintext highlighter-rouge">id</code>, or <code class="language-plaintext highlighter-rouge">nil</code> if it doesn’t exist.</p>
<h3 id="getunittype">
  
  
    getUnitType <a href="#getunittype"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getUnitType(id: integer)
  -&gt; unitType: unitTypeObject|nil
</code></pre></div></div>
<p>Returns the unit type with id <code class="language-plaintext highlighter-rouge">id</code>, or <code class="language-plaintext highlighter-rouge">nil</code> if it doesn’t exist.</p>
<h3 id="getwonder">
  
  
    getWonder <a href="#getwonder"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getWonder(id: integer)
  -&gt; wonder: wonderObject|nil
</code></pre></div></div>
<p>Returns the wonder with id <code class="language-plaintext highlighter-rouge">id</code> (0-27), or <code class="language-plaintext highlighter-rouge">nil</code> if it doesn’t exist.</p>
<h3 id="givetech">
  
  
    giveTech <a href="#givetech"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.giveTech(tribe: tribeObject, tech: techObject)
</code></pre></div></div>
<p>Gives tech <code class="language-plaintext highlighter-rouge">tech</code> to tribe <code class="language-plaintext highlighter-rouge">tribe</code>.</p>
<h3 id="hasimprovement">
  
  
    hasImprovement <a href="#hasimprovement"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.hasImprovement(city: cityObject, improvement: improvementObject)
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if city <code class="language-plaintext highlighter-rouge">city</code> has improvement <code class="language-plaintext highlighter-rouge">improvement</code>, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>
<h3 id="hastech">
  
  
    hasTech <a href="#hastech"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.hasTech(tribe: tribeObject, tech: techObject)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if tribe <code class="language-plaintext highlighter-rouge">tribe</code> has tech <code class="language-plaintext highlighter-rouge">tech</code>, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="isbaseterrain">
  
  
    isBaseTerrain <a href="#isbaseterrain"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isBaseTerrain(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a base terrain, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="iscity">
  
  
    isCity <a href="#iscity"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isCity(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a city, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="isdialog">
  
  
    isDialog <a href="#isdialog"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isDialog(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a dialog, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="isimage">
  
  
    isImage <a href="#isimage"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isImage(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is an image, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="isimprovement">
  
  
    isImprovement <a href="#isimprovement"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isImprovement(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a city improvement, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="isleader">
  
  
    isLeader <a href="#isleader"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isLeader(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a leader, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="ismap">
  
  
    isMap <a href="#ismap"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isMap(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a map, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="istech">
  
  
    isTech <a href="#istech"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isTech(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a tech, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="isterrain">
  
  
    isTerrain <a href="#isterrain"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isTerrain(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a terrain, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="istile">
  
  
    isTile <a href="#istile"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isTile(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a tile, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="istraderoute">
  
  
    isTradeRoute <a href="#istraderoute"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isTradeRoute(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a trade route, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="istribe">
  
  
    isTribe <a href="#istribe"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isTribe(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a tribe, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="isunit">
  
  
    isUnit <a href="#isunit"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isUnit(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a unit, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="isunittype">
  
  
    isUnitType <a href="#isunittype"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isUnitType(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a unit type, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="iswonder">
  
  
    isWonder <a href="#iswonder"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isWonder(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a wonder, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="iteratecities">
  
  
    iterateCities <a href="#iteratecities"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.iterateCities()
  -&gt; fun():cityObject
</code></pre></div></div>
<p>Returns an iterator yielding all cities in the game.</p>

<p>@<em>return</em> —</p>
<h3 id="iterateunits">
  
  
    iterateUnits <a href="#iterateunits"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.iterateUnits()
  -&gt; fun():unitObject
</code></pre></div></div>
<p>Returns an iterator yielding all units in the game.</p>

<p>@<em>return</em> —</p>
<h3 id="killtribe">
  
  
    killTribe <a href="#killtribe"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.killTribe(tribe: tribeObject)
</code></pre></div></div>
<p>Removes tribe <code class="language-plaintext highlighter-rouge">tribe</code> from the game. All its cities and units are removed.</p>
<h3 id="makeaggression">
  
  
    makeAggression <a href="#makeaggression"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.makeAggression(who: tribeObject, whom: tribeObject)
</code></pre></div></div>
<p>Cancels any peace treaties between tribe <code class="language-plaintext highlighter-rouge">who</code> and tribe <code class="language-plaintext highlighter-rouge">whom</code>, and make <code class="language-plaintext highlighter-rouge">who</code> declare war on <code class="language-plaintext highlighter-rouge">whom</code>.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">who</code> — The tribe declaring war.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">whom</code> — The tribe not declaring war.</p>
<h3 id="playmusic">
  
  
    playMusic <a href="#playmusic"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.playMusic(trackOrFilename: string|integer)
</code></pre></div></div>
<p>Plays CD track <code class="language-plaintext highlighter-rouge">trackNo</code>, or with the DirectShow music patch enabled, play the file given by <code class="language-plaintext highlighter-rouge">filename</code>, where <code class="language-plaintext highlighter-rouge">filename</code> is relative to the ‘Music’ directory.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">trackOrFilename</code> — Track number of cd or filename of music.</p>
<h3 id="playsound">
  
  
    playSound <a href="#playsound"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.playSound(filename: string)
</code></pre></div></div>
<p>Plays the sound file given by <code class="language-plaintext highlighter-rouge">filename</code>.</p>
<h3 id="playvideo">
  
  
    playVideo <a href="#playvideo"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.playVideo(filename: string)
</code></pre></div></div>
<p>Plays the video file given by <code class="language-plaintext highlighter-rouge">filename</code>.</p>
<h3 id="removeimprovement">
  
  
    removeImprovement <a href="#removeimprovement"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.removeImprovement(city: cityObject, improvement: improvementObject)
</code></pre></div></div>
<p>Removes city improvement <code class="language-plaintext highlighter-rouge">improvement</code> from city <code class="language-plaintext highlighter-rouge">city</code>.</p>
<h3 id="sleep">
  
  
    sleep <a href="#sleep"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.sleep(milliseconds: integer)
</code></pre></div></div>
<p>Sleeps for the given number of milliseconds.</p>
<h3 id="taketech">
  
  
    takeTech <a href="#taketech"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.takeTech(tribe: tribeObject, tech: techObject, collapse?: boolean)
</code></pre></div></div>
<p>Takes away tech <code class="language-plaintext highlighter-rouge">tech</code> from tribe <code class="language-plaintext highlighter-rouge">tribe</code>, the optional <code class="language-plaintext highlighter-rouge">collapse</code> parameter determines whether to take away all techs that have <code class="language-plaintext highlighter-rouge">tech</code> as a prerequisite somewhere up the tree.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">collapse</code> — false by default</p>
<h3 id="teleportunit">
  
  
    teleportUnit <a href="#teleportunit"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.teleportUnit(unit: unitObject, tile: tileObject)
</code></pre></div></div>
<p>Teleports (i.e. moves at no cost) unit <code class="language-plaintext highlighter-rouge">unit</code> to tile <code class="language-plaintext highlighter-rouge">tile</code>. The unit is moved regardless of whether it is a valid location for the unit. To check this, see <code class="language-plaintext highlighter-rouge">civ.canEnter</code> and <code class="language-plaintext highlighter-rouge">civlua.isValidUnitLocation</code>.</p>
<h2 id="civui">
  
  
    civ.ui <a href="#civui"><span class="self-link">&#128279</span></a>
  
  
</h2>
    
<h3 id="centerview">
  
  
    centerView <a href="#centerview"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.ui.centerView(tile: tileObject)
</code></pre></div></div>
<p>Centers the map on the given tile.</p>
<h3 id="createdialog">
  
  
    createDialog <a href="#createdialog"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.ui.createDialog()
  -&gt; dialog: dialogObject
</code></pre></div></div>
<p>Creates and initializes a dialog. See the dialog section for more details.</p>
<h3 id="loadimage">
  
  
    loadImage <a href="#loadimage"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.ui.loadImage(filename: string, x: integer, y: integer, width: integer, height: integer)
  -&gt; image: imageObject
</code></pre></div></div>
<p>Loads an image (BMP or GIF) from <code class="language-plaintext highlighter-rouge">filename</code>. Optionally accepts <code class="language-plaintext highlighter-rouge">x</code>, <code class="language-plaintext highlighter-rouge">y</code>, <code class="language-plaintext highlighter-rouge">width</code> and <code class="language-plaintext highlighter-rouge">height</code> to load part of the image.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">x</code> — pixel (x,y) is the top left corner of sub image</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">y</code> — pixel (x,y) is the top left corner of sub image</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">width</code> — width of sub image</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">height</code> — height of sub image</p>
<h3 id="loadterrain">
  
  
    loadTerrain <a href="#loadterrain"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.ui.loadTerrain(map: integer|mapObject, filename1: string, filename2: string)
</code></pre></div></div>
<p>Replaces terrain graphics for map number <code class="language-plaintext highlighter-rouge">map</code>, loading graphics from <code class="language-plaintext highlighter-rouge">filename1</code> (corresponding to “TERRAIN1.BMP”) and <code class="language-plaintext highlighter-rouge">filename2</code> (corresponding to “TERRAIN2.BMP”)</p>
<h3 id="redrawmap">
  
  
    redrawMap <a href="#redrawmap"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.ui.redrawMap()
</code></pre></div></div>
<p>Redraws the entire map.</p>
<h3 id="redrawtile">
  
  
    redrawTile <a href="#redrawtile"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.ui.redrawTile(tile: tileObject)
</code></pre></div></div>
<p>Redraws the given tile.</p>
<h3 id="setzoom">
  
  
    setZoom <a href="#setzoom"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.ui.setZoom(integer: integer)
</code></pre></div></div>
<p>Sets the zoom level (range from -7 (max zoom out) to 8 (max zoom in)).</p>
<h3 id="text">
  
  
    text <a href="#text"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.ui.text(string: string, ...string)
</code></pre></div></div>
<p>Display a pop-up text box with the given string as text.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">string</code> — text to show in a text box</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">...</code> — more text</p>
<h3 id="zoomin">
  
  
    zoomIn <a href="#zoomin"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.ui.zoomIn()
</code></pre></div></div>
<p>Zooms in on the map (increases zoom level by 1).</p>
<h3 id="zoomout">
  
  
    zoomOut <a href="#zoomout"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.ui.zoomOut()
</code></pre></div></div>
<p>Zooms out of the map (decreases zoom level by 1).</p>
<h2 id="civcosmic">
  
  
    civ.cosmic <a href="#civcosmic"><span class="self-link">&#128279</span></a>
  
  
</h2>
    
<h3 id="communismpalacedistance">
  
  
    communismPalaceDistance <a href="#communismpalacedistance"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.communismPalaceDistance --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the distance from palace used in happiness calculations under Communism.</p>
<h3 id="foodeaten">
  
  
    foodEaten <a href="#foodeaten"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.foodEaten --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the amount of food eaten by each citizen each turn.</p>
<h3 id="foodrows">
  
  
    foodRows <a href="#foodrows"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.foodRows --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the number of rows in the food box.</p>
<h3 id="goodiehutsmask">
  
  
    goodieHutsMask <a href="#goodiehutsmask"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.goodieHutsMask --&gt; bitmask
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the bitmask for goodie huts.</p>
<h3 id="helispickuphuts">
  
  
    helisPickupHuts <a href="#helispickuphuts"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.helisPickupHuts --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns whether helicopters (domain 1, range 0 units) pick up huts or not.</p>
<h3 id="massthrustparadigm">
  
  
    massThrustParadigm <a href="#massthrustparadigm"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.massThrustParadigm --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the mass/thrust paradigm.</p>
<h3 id="numberofunittypes">
  
  
    numberOfUnitTypes <a href="#numberofunittypes"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.numberOfUnitTypes --&gt; integer
</code></pre></div></div>
<p>(get) Returns the number of unit types from the @COSMIC2 key of the same name.</p>
<h3 id="paradroprange">
  
  
    paradropRange <a href="#paradroprange"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.paradropRange --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the maximum paradrop range.</p>
<h3 id="penaltybetrayal">
  
  
    penaltyBetrayal <a href="#penaltybetrayal"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.penaltyBetrayal --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the penalty to the civilization score for each betrayal of another tribe.</p>
<h3 id="prodchangepenalty">
  
  
    prodChangePenalty <a href="#prodchangepenalty"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.prodChangePenalty --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the shield penalty percentage for changing production types.</p>
<h3 id="riotfactor">
  
  
    riotFactor <a href="#riotfactor"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.riotFactor --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the riot factor based on the number of cities.</p>
<h3 id="roadmultiplier">
  
  
    roadMultiplier <a href="#roadmultiplier"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.roadMultiplier --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the road movement multiplier.</p>
<h3 id="sciencelostfundamentalism">
  
  
    scienceLostFundamentalism <a href="#sciencelostfundamentalism"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.scienceLostFundamentalism --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the percentage of science lost under Fundamentalism.</p>
<h3 id="scienceratefundamentalism">
  
  
    scienceRateFundamentalism <a href="#scienceratefundamentalism"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.scienceRateFundamentalism --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the maximum effective science rate under Fundamentalism.</p>
<h3 id="scorecentauri">
  
  
    scoreCentauri <a href="#scorecentauri"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.scoreCentauri --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the civilization score for each landing on Alpha Centauri first. Multiplied by number of habitats and success probability.</p>
<h3 id="scorecitizen">
  
  
    scoreCitizen <a href="#scorecitizen"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.scoreCitizen --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the civilization score for each citizen.</p>
<h3 id="scorefuturetech">
  
  
    scoreFutureTech <a href="#scorefuturetech"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.scoreFutureTech --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the civilization score for each future technology researched.</p>
<h3 id="scorepeace">
  
  
    scorePeace <a href="#scorepeace"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.scorePeace --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the civilization score for each turn of peace after turn 199.</p>
<h3 id="scorepollution">
  
  
    scorePollution <a href="#scorepollution"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.scorePollution --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the civilization score for each extant non-AI controlled polluted tile. Normally a negative value, i.e. a penalty.</p>
<h3 id="scoreunitkilled">
  
  
    scoreUnitKilled <a href="#scoreunitkilled"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.scoreUnitKilled --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the civilization score for each unit killed.</p>
<h3 id="scorewonder">
  
  
    scoreWonder <a href="#scorewonder"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.scoreWonder --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the civilization score for each wonder.</p>
<h3 id="settlerseathigh">
  
  
    settlersEatHigh <a href="#settlerseathigh"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.settlersEatHigh --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the amount of food eaten by settlers for governments ≥ Communism.</p>
<h3 id="settlerseatlow">
  
  
    settlersEatLow <a href="#settlerseatlow"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.settlersEatLow --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the amount of food eaten by settlers for governments ≤ Monarchy.</p>
<h3 id="shieldrows">
  
  
    shieldRows <a href="#shieldrows"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.shieldRows --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the number of rows in the shield box.</p>
<h3 id="sizeaquaduct">
  
  
    sizeAquaduct <a href="#sizeaquaduct"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.sizeAquaduct --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the city size that cannot be exceeded without an Aquaduct.</p>
<h3 id="sizesewer">
  
  
    sizeSewer <a href="#sizesewer"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.sizeSewer --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the city size that cannot be exceeded without a Sewer System.</p>
<h3 id="sizeunhappiness">
  
  
    sizeUnhappiness <a href="#sizeunhappiness"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.sizeUnhappiness --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the city size at which the first unhappy citizen appears at Chieftain difficulty.</p>
<h3 id="supportcommunism">
  
  
    supportCommunism <a href="#supportcommunism"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.supportCommunism --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the number of units that are free of support under Communism.</p>
<h3 id="supportfundamentalism">
  
  
    supportFundamentalism <a href="#supportfundamentalism"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.supportFundamentalism --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the number of units that are free of support costs under Fundamentalism.</p>
<h3 id="supportmonarchy">
  
  
    supportMonarchy <a href="#supportmonarchy"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.supportMonarchy --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the number of units that are free of support under Monarchy.</p>
<h3 id="techparadigm">
  
  
    techParadigm <a href="#techparadigm"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.techParadigm --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the tech paradigm. Scenarios use civ.scen.params.techParadigm instead of this value.</p>
<h3 id="transformbase">
  
  
    transformBase <a href="#transformbase"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.transformBase --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the base time needed for engineers to transform terrain.</p>
<h3 id="triremelost">
  
  
    triremeLost <a href="#triremelost"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.triremeLost --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the 1 in x chance of a trireme getting lost at sea.</p>
<h2 id="civgame">
  
  
    civ.game <a href="#civgame"><span class="self-link">&#128279</span></a>
  
  
</h2>
    
<h3 id="activetribes">
  
  
    activeTribes <a href="#activetribes"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.game.activeTribes --&gt; bitmask
</code></pre></div></div>
<p>(get/set) Returns the active tribe mask.</p>
<h3 id="barbarianactivity">
  
  
    barbarianActivity <a href="#barbarianactivity"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.game.barbarianActivity --&gt; integer
</code></pre></div></div>
<p>(get/set) Returns the level of barbarian activity.</p>
<h3 id="difficulty">
  
  
    difficulty <a href="#difficulty"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.game.difficulty --&gt; integer
</code></pre></div></div>
<p>(get/set) Returns the difficulty level.</p>
<h3 id="gameyear">
  
  
    gameYear <a href="#gameyear"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.game.gameYear --&gt; integer
</code></pre></div></div>
<p>(get/set) Returns the game year, or for scenarios with monthly increments, the number of months * 12.</p>
<h3 id="humanplayers">
  
  
    humanPlayers <a href="#humanplayers"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.game.humanPlayers --&gt; bitmask
</code></pre></div></div>
<p>(get/set) Returns the human players mask.</p>
<h3 id="humantribe">
  
  
    humanTribe <a href="#humantribe"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.game.humanTribe --&gt; tribeObject
</code></pre></div></div>
<p>(get) Returns the last active human tribe.</p>
<h3 id="peaceturns">
  
  
    peaceTurns <a href="#peaceturns"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.game.peaceTurns --&gt; integer
</code></pre></div></div>
<p>(get/set) Returns the number of turns of peace.</p>
<h3 id="revealmap">
  
  
    revealMap <a href="#revealmap"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.game.revealMap --&gt; boolean
</code></pre></div></div>
<p>(get/set) Returns whether or not the full map is revealed.</p>
<h3 id="turnselapsed">
  
  
    turnsElapsed <a href="#turnselapsed"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.game.turnsElapsed --&gt; integer
</code></pre></div></div>
<p>(get/set) Returns the number of turns elapsed.</p>
<h2 id="civgamerules">
  
  
    civ.game.rules <a href="#civgamerules"><span class="self-link">&#128279</span></a>
  
  
</h2>
    
<h3 id="flatworld">
  
  
    flatWorld <a href="#flatworld"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.game.rules.flatWorld --&gt; boolean
</code></pre></div></div>
<p>(get/set) Returns <code class="language-plaintext highlighter-rouge">true</code> if the world map is flat, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>
<h2 id="civscenparams">
  
  
    civ.scen.params <a href="#civscenparams"><span class="self-link">&#128279</span></a>
  
  
</h2>
    
<h3 id="decisivedefeat">
  
  
    decisiveDefeat <a href="#decisivedefeat"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.scen.params.decisiveDefeat --&gt; integer
</code></pre></div></div>
<p>(get/set) Number of objectives required for a decisive defeat.</p>
<h3 id="decisivevictory">
  
  
    decisiveVictory <a href="#decisivevictory"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.scen.params.decisiveVictory --&gt; integer
</code></pre></div></div>
<p>(get/set) Number of objectives required for a decisive victory.</p>
<h3 id="flags">
  
  
    flags <a href="#flags"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.scen.params.flags --&gt; bitmask
</code></pre></div></div>
<p>(get/set) Bitmask representing scenario flags:<br /> <br />00000000 00000001 Total war <br />00000000 00000010 Use objective victory <br />00000000 00000100 Count wonders as objectives <br />00000000 00001000 Reveal cities <br />00000000 00010000 No government change <br />00000000 00100000 No tech conquest <br />00000000 01000000 No pollution <br />00000000 10000000 Terrain animation lockout <br />00000001 00000000 Unit animation lockout <br />00000010 00000000 .SPR file override <br />10000000 00000000 WWII AI</p>
<h3 id="marginaldefeat">
  
  
    marginalDefeat <a href="#marginaldefeat"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.scen.params.marginalDefeat --&gt; integer
</code></pre></div></div>
<p>(get/set) Number of objectives required for a marginal defeat.</p>
<h3 id="marginalvictory">
  
  
    marginalVictory <a href="#marginalvictory"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.scen.params.marginalVictory --&gt; integer
</code></pre></div></div>
<p>(get/set) Number of objectives required for a marginal victory.</p>
<h3 id="maxturns">
  
  
    maxTurns <a href="#maxturns"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.scen.params.maxTurns --&gt; integer
</code></pre></div></div>
<p>(get/set) Maximum number of turns before the scenario ends.</p>
<h3 id="name">
  
  
    name <a href="#name"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.scen.params.name --&gt; string
</code></pre></div></div>
<p>(get/set) The name of the scenario.</p>
<h3 id="objectivesprotagonist">
  
  
    objectivesProtagonist <a href="#objectivesprotagonist"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.scen.params.objectivesProtagonist --&gt; tribeObject
</code></pre></div></div>
<p>(get/set) Returns the objectives protagonist.</p>
<h3 id="startingyear">
  
  
    startingYear <a href="#startingyear"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.scen.params.startingYear --&gt; integer
</code></pre></div></div>
<p>(get) Returns the starting year of the scenario.</p>
<h3 id="techparadigm-1">
  
  
    techParadigm <a href="#techparadigm-1"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.scen.params.techParadigm --&gt; integer
</code></pre></div></div>
<p>(get/set) Returns the tech paradigm used by the scenario. Non-scenario games use civ.cosmic.techParadigm instead of this value.</p>
<h3 id="yearincrement">
  
  
    yearIncrement <a href="#yearincrement"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.scen.params.yearIncrement --&gt; integer
</code></pre></div></div>
<p>(get/set) Returns the year increment (number of years per turn). Negative for monthly increments.</p>
<h2 id="civscencompatibility">
  
  
    civ.scen.compatibility <a href="#civscencompatibility"><span class="self-link">&#128279</span></a>
  
  
</h2>
    
<h3 id="activateuniteverymove">
  
  
    activateUnitEveryMove <a href="#activateuniteverymove"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.scen.compatibility.activateUnitEveryMove --&gt; boolean
</code></pre></div></div>
<p>If set to true, onActivateUnit will re-trigger for every tile the active unit moves. Defaults to false, in which case onActivateUnit triggers only once.  In the Lua Scenario Template, this is set to true in LuaParameterFiles\parameters.lua.</p>
<h2 id="civscen">
  
  
    civ.scen <a href="#civscen"><span class="self-link">&#128279</span></a>
  
  
</h2>
    
<h3 id="onactivateunit">
  
  
    onActivateUnit <a href="#onactivateunit"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onActivateUnit(code: fun(unit: unitObject, source: boolean, repeatMove: boolean))
</code></pre></div></div>
<p>Registers a function to be called every time a unit is activated. The callback takes the unit activated as a parameter, and the source of unit activation. <code class="language-plaintext highlighter-rouge">source</code> is <code class="language-plaintext highlighter-rouge">true</code> if activated by keyboard or mouse click, <code class="language-plaintext highlighter-rouge">false</code> if activated by the game itself. <code class="language-plaintext highlighter-rouge">repeatMove</code> is <code class="language-plaintext highlighter-rouge">true</code> if it’s a repeat activation caused by moving (see civ.scen.compatibility), <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>
<h3 id="onbribeunit">
  
  
    onBribeUnit <a href="#onbribeunit"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onBribeUnit(code: fun(unit: unitObject, previousOwner: tribeObject))
</code></pre></div></div>
<p>Registers a function that is called when a unit is bribed successfully. unit.owner is the new owner at this point, <code class="language-plaintext highlighter-rouge">previousOwner</code> the old owner.</p>
<h3 id="oncalculatecityyield">
  
  
    onCalculateCityYield <a href="#oncalculatecityyield"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onCalculateCityYield(code: fun(city: cityObject, food: integer, shields: integer, trade: integer):(foodChange: integer, shieldChangeBeforeWaste: integer, shieldChangeAfterWaste: integer, tradeChangeBeforeCor...(too long)...: integer))
</code></pre></div></div>
<p>Registers a function to be called every time a city calculates its total resource yield. Input is the city, and the food, shields and trade of its tiles. Returns a 5-tuple of modifiers, food change, shield change before waste, shield change after waste, trade change before corruption, trade change after corruption. These modifiers are applied at the following points in the calculation:
<br />Calculate yield from all worked tiles
<br />Run onCalculateCityYield
<br />Add foodChange, shieldChangeBeforeWaste and tradeChangeBeforeCorruption
<br />Add changes from food trade routes
<br />Add shields from improvements
<br />Calculate and subtract waste
<br />Calculate corruption and add changes from commodity trade routes
<br />Calculate corruption again (now using the value after trade routes) and subtract.
<br />Add shieldChangeAfterWaste and tradeChangeAfterCorruption
<br />Calculate Tax/Lux/Sci</p>
<h3 id="oncanbuild">
  
  
    onCanBuild <a href="#oncanbuild"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onCanBuild(code: fun(defaultBuildFunction: fun(city: cityObject, item: improvementObject|unitTypeObject|wonderObject):(cityCanBuildItemByDefault: boolean, city: cityObject, item: improvementObject|...(too long)...: boolean))
</code></pre></div></div>
<p>Registers a function to be called every time a check is done whether a city can build something or not. It is called for all unit types, improvements and wonders. The first parameter of the callback is the default build function, as implemented by the game. It takes the city and item as parameters. You can call this to produce a result for cases you don’t need to handle yourself. <code class="language-plaintext highlighter-rouge">item</code> can be a unittype, improvement or wonder.
Return <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">city</code> is allowed to produce <code class="language-plaintext highlighter-rouge">item</code>, <code class="language-plaintext highlighter-rouge">false</code> if not.</p>
<h3 id="oncanfoundcity">
  
  
    onCanFoundCity <a href="#oncanfoundcity"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onCanFoundCity(code: fun(unit: unitObject, advancedTribe: boolean):boolean)
</code></pre></div></div>
<p>Registers a function that is called to determine if <code class="language-plaintext highlighter-rouge">unit</code> can found a city at the unit’s location. <code class="language-plaintext highlighter-rouge">advancedTribe</code> is <code class="language-plaintext highlighter-rouge">true</code> when picking up a hut with <code class="language-plaintext highlighter-rouge">unit</code> triggers an advanced tribe. Return <code class="language-plaintext highlighter-rouge">true</code> to allow, <code class="language-plaintext highlighter-rouge">false</code> to disallow.</p>
<h3 id="oncentauriarrival">
  
  
    onCentauriArrival <a href="#oncentauriarrival"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onCentauriArrival(code: fun(tribe: tribeObject))
</code></pre></div></div>
<p>Registers a function that is called when a tribe’s spaceship reaches its target. Just registering this function causes the game to not end at this point (“endgame override”).</p>
<h3 id="onchoosedefender">
  
  
    onChooseDefender <a href="#onchoosedefender"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onChooseDefender(code: fun(defaultFunction: fun(tile: tileObject, attacker: unitObject):(chosenUnit: unitObject), tile: tileObject, attacker: unitObject, isCombat: boolean):(chosenUnit: unitObject))
</code></pre></div></div>
<p>Registers a function that is called every time a unit is chosen to defend a tile. The first parameter is the default function as implemented by the game. It takes <code class="language-plaintext highlighter-rouge">tile</code> and <code class="language-plaintext highlighter-rouge">attacker</code> as parameters. You can call this to produce a result for cases you don’t need to handle yourself. The second parameter is the tile that’s being considered, the third is the attacking unit, and the fourth, <code class="language-plaintext highlighter-rouge">isCombat</code>, is a boolean that indicates if this invocation will be followed by combat. This function is also called by the AI to determine its goals, in which case <code class="language-plaintext highlighter-rouge">isCombat</code> is false.</p>
<h3 id="oncitydestroyed">
  
  
    onCityDestroyed <a href="#oncitydestroyed"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onCityDestroyed(code: fun(city: cityObject))
</code></pre></div></div>
<p>Registers a function that is called when a city is destroyed.</p>
<h3 id="oncityfounded">
  
  
    onCityFounded <a href="#oncityfounded"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onCityFounded(code: fun(city: cityObject)|fun(city: cityObject):fun())
</code></pre></div></div>
<p>Registers a function to be called every time a city is founded. The callback takes the city as a parameter, and can optionally return a function (since 0.18) that is called to perform cleanup when the user cancels founding the city.</p>
<h3 id="oncityprocessingcomplete">
  
  
    onCityProcessingComplete <a href="#oncityprocessingcomplete"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onCityProcessingComplete(code: fun(turn: integer, tribe: tribeObject))
</code></pre></div></div>
<p>Registers a function that is called when a tribe’s cities have been processed for that turn. See <code class="language-plaintext highlighter-rouge">onTurn</code> for interaction with other “turn” triggers.</p>
<h3 id="oncityproduction">
  
  
    onCityProduction <a href="#oncityproduction"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onCityProduction(code: fun(city: cityObject, prod: improvementObject|unitObject|wonderObject))
</code></pre></div></div>
<p>Registers a function that is called when a city completes its production order. The produced item <code class="language-plaintext highlighter-rouge">prod</code> is either a unit, improvement or wonder (this can be checked with the civ.is* functions).</p>
<h3 id="oncitytaken">
  
  
    onCityTaken <a href="#oncitytaken"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onCityTaken(code: fun(city: cityObject, defender: tribeObject))
</code></pre></div></div>
<p>Registers a function that is called when a city is captured. <code class="language-plaintext highlighter-rouge">city</code> is the city changing hands, at this point city.owner is the new owner already. <code class="language-plaintext highlighter-rouge">defender</code> is the old owner.</p>
<h3 id="ongameends">
  
  
    onGameEnds <a href="#ongameends"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onGameEnds(code: fun(reason: gameEndReasons):(gameIsOver: boolean))
</code></pre></div></div>
<p>Registers a function that is called when the game ends. <code class="language-plaintext highlighter-rouge">reason</code> is an integer between 1 and 6:
<br />1 and 2 - Space race victory. This does not trigger if <code class="language-plaintext highlighter-rouge">onCentauriArrival</code> has a callback registered. 1 means victory by active player.
<br />3 - Conquest victory
<br />4 - Defeat
<br />5 - Retirement
<br />6 - Macro ENDGAME action
<br />Return <code class="language-plaintext highlighter-rouge">true</code> to end the game, <code class="language-plaintext highlighter-rouge">false</code> to keep playing.</p>
<h3 id="ongetformatteddate">
  
  
    onGetFormattedDate <a href="#ongetformatteddate"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onGetFormattedDate(code: fun(turn: integer, defaultDateString: string):(displayedDate: string))
</code></pre></div></div>
<p>Registers a function that is called when the game needs to get the date string for a given turn (e.g. “4000 B.C.” for turn 1). <code class="language-plaintext highlighter-rouge">turn</code> is the turn for which the date is requested (not always the current turn), and <code class="language-plaintext highlighter-rouge">defaultDateString</code> is the string as formatted by the game</p>
<h3 id="ongetrushbuycost">
  
  
    onGetRushBuyCost <a href="#ongetrushbuycost"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onGetRushBuyCost(code: fun(city: cityObject, defaultCost: integer):(costToComplete: integer))
</code></pre></div></div>
<p>Registers a function that is called when calculating the cost to rush-buy a city’s current production. It takes the city and the cost as calculated by the game as parameters. Returns an integer representing the new costs.</p>
<h3 id="oninitiatecombat">
  
  
    onInitiateCombat <a href="#oninitiatecombat"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onInitiateCombat(code: fun(attacker: unitObject, defender: unitObject, attackerDie: integer, attackerPower: integer, defenderDie: integer, defenderPower: integer, isSneakAttack: boolean):thread)
</code></pre></div></div>
<p>Registers a function to be called every time combat is initiated. The callback takes seven parameters, the attacker, the defender, attackerDie (‘die’ as in dice, the attacker’s chance to hit), attackerPower (attacker’s firepower), defenderDie, defenderPower and isSneakAttack. Returns a coroutine that yields every time it wants to process a round, and returns when it wants combat to end. Example:</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">civ</span><span class="p">.</span><span class="n">scen</span><span class="p">.</span><span class="n">onInitiateCombat</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="n">attacker</span><span class="p">,</span> <span class="n">defender</span><span class="p">,</span> <span class="n">attackerDie</span><span class="p">,</span> <span class="n">attackerPower</span><span class="p">,</span> <span class="n">defenderDie</span><span class="p">,</span> <span class="n">defenderPower</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"Attacker's die: 1d"</span> <span class="o">..</span> <span class="n">attackerDie</span> <span class="o">..</span> <span class="s2">", firepower: "</span> <span class="o">..</span> <span class="n">attackerPower</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"Defender's die: 1d"</span> <span class="o">..</span> <span class="n">defenderDie</span> <span class="o">..</span> <span class="s2">", firepower: "</span> <span class="o">..</span> <span class="n">defenderPower</span><span class="p">)</span>
  <span class="k">return</span> <span class="nb">coroutine.create</span><span class="p">(</span><span class="k">function</span> <span class="p">()</span>
    <span class="kd">local</span> <span class="n">round</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">round</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="ow">and</span> <span class="n">attacker</span><span class="p">.</span><span class="n">hitpoints</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">defender</span><span class="p">.</span><span class="n">hitpoints</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">do</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">"Round "</span> <span class="o">..</span> <span class="n">round</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">attacker</span><span class="p">,</span> <span class="n">defender</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">round</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">then</span>
        <span class="n">attacker</span><span class="p">.</span><span class="n">damage</span> <span class="o">=</span> <span class="n">attacker</span><span class="p">.</span><span class="n">damage</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="nb">coroutine.yield</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="n">defender</span><span class="p">)</span> <span class="c1">-- either attacker or defender</span>
      <span class="k">else</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Attack bonus!"</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">coroutine.yield</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="n">attackerDie</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">attackerPower</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">winner</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">attackerRoll</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">defenderRoll</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">reroll</span><span class="p">)</span>
      <span class="k">end</span>
      <span class="n">round</span> <span class="o">=</span> <span class="n">round</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">end</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"End of combat"</span><span class="p">)</span>
  <span class="k">end</span><span class="p">)</span>
<span class="k">end</span><span class="p">)</span>
</code></pre></div></div>

<p>This example shows how to limit combat to five rounds, damages the attacker on even rounds and doubles the attacker’s values on odd rounds.</p>

<p>If the coroutine yields true as its first value, the game’s default combat resolution is skipped for that round and the designer is responsible for updating damage. The second value yielded is either the attacker or the defender, this is used to render animations etc. In this case the coroutine resumes without any values.</p>

<p>If the coroutine yields false as its first value, the game runs its default combat algorithm. The designer can additionally yield modified values for attackerDie, attackerPower, defenderDie and defenderPower (in this order) which will be used by the game for that round. In this case the coroutine resumes with the result of the round, a table containing four values:</p>
<ul>
  <li>winner, this is either attacker or defender.</li>
  <li>attackerRoll, the result of the attacker’s die roll</li>
  <li>defenderRoll, the result of the defender’s die roll</li>
  <li>reroll, true if a reroll happened.</li>
</ul>

<p>This can happen only if the attacker is tribe 0, the defender is a unit guarding a city, and the city is the capital or the tribe has less than 8 cities in total and the attacker’s die roll is higher than the defender’s. A reroll can happen at most once.</p>
<h3 id="onkeypress">
  
  
    onKeyPress <a href="#onkeypress"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onKeyPress(code: function)
</code></pre></div></div>
<p>Registers a function to be called every time a key is pressed.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">code</code> — (keyCode:integer)</p>
<h3 id="onload">
  
  
    onLoad <a href="#onload"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onLoad(code: fun(savedData: string))
</code></pre></div></div>
<p>Registers a function that is called when the game is loaded.</p>
<h3 id="onnegotiation">
  
  
    onNegotiation <a href="#onnegotiation"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onNegotiation(code: fun(talker: tribeObject, listener: tribeObject):(canTalk: boolean))
</code></pre></div></div>
<p>Registers a function that is called when two tribes attempt negotiations. <code class="language-plaintext highlighter-rouge">talker</code> is the tribe initiating the contact, <code class="language-plaintext highlighter-rouge">listener</code> the receiver. Return <code class="language-plaintext highlighter-rouge">true</code> to allow the negotiations to commence, <code class="language-plaintext highlighter-rouge">false</code> to deny.</p>
<h3 id="onresolvecombat">
  
  
    onResolveCombat <a href="#onresolvecombat"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onResolveCombat(code: fun(defaultResolutionFunction: fun(defender: unitObject, attacker: unitObject):(combatContinues: boolean), defender: unitObject, attacker: unitObject):(combatContinues: boolean))
</code></pre></div></div>
<p>Registers a function to be called during every combat turn. The first parameter of the callback is the default resolution function, as implemented by the game. It takes the attacker and defender as parameters. You can call this to produce a result for cases you don’t need to handle yourself.
Return <code class="language-plaintext highlighter-rouge">true</code> to continue combat, <code class="language-plaintext highlighter-rouge">false</code> to stop.</p>

<p>See onInitiateCombat for replacement.</p>
<h3 id="onsave">
  
  
    onSave <a href="#onsave"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onSave(code: fun():(savedData: string))
</code></pre></div></div>
<p>Registers a function that is called when the game is saved.</p>
<h3 id="onscenarioloaded">
  
  
    onScenarioLoaded <a href="#onscenarioloaded"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onScenarioLoaded(code: fun())
</code></pre></div></div>
<p>Registers a function that is called when the scenario is loaded.  (This is whenever a game is loaded, not just when the scenario is started.)</p>
<h3 id="onschism">
  
  
    onSchism <a href="#onschism"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onSchism(code: fun(tribe: tribeObject):(allowSchism: boolean))
</code></pre></div></div>
<p>Registers a function that is called when a schism is triggered. This happens when the capital of a AI-controlled tribe with more than four cities is captured, and, if the attacker is human-controlled, it is ranked lower in power than the defender. If the attacker is AI-controlled the best human tribe must be ranked lower than the defender for the schism to trigger.
If the schism is allowed, a new tribe will be created that takes over about half the cities of the old tribe. If no new tribe can be created, the schism does not occur.
Return <code class="language-plaintext highlighter-rouge">true</code> to allow the schism to happen, <code class="language-plaintext highlighter-rouge">false</code> to deny.</p>
<h3 id="onselectmusic">
  
  
    onSelectMusic <a href="#onselectmusic"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onSelectMusic(code: fun(track: integer|nil):integer|nil)
</code></pre></div></div>
<p>Registers a function that is called when a new music track is to be played. <code class="language-plaintext highlighter-rouge">track</code> is either nil or an integer. If nil, the game wants to play a random track, if not nil it’s either due to the user choosing a track from the menu (first track has id 0), or the game playing one of it’s special tracks (“Funeral March” - track id 0, and “Ode to Joy” - track id 1). To handle special tracks, you can return nil to signal that the game should play the default track associated with that track id. If you want to handle this track id, call civ.playMusic (this will check the Music folder of the scenario first before falling back to the global Music folder) and return an integer, which is used to synchronize the track list in the menu. The track names can be added in @PICKMUSICTOT in Game.txt.</p>
<h3 id="ontribeturnbegin">
  
  
    onTribeTurnBegin <a href="#ontribeturnbegin"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onTribeTurnBegin(code: fun(turn: integer, tribe: tribeObject))
</code></pre></div></div>
<p>Registers a function that is called at the start of a tribe’s turn. See <code class="language-plaintext highlighter-rouge">onTurn</code> for interaction with other “turn” triggers.</p>
<h3 id="ontribeturnend">
  
  
    onTribeTurnEnd <a href="#ontribeturnend"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onTribeTurnEnd(code: fun(turn: integer, tribe: tribeObject))
</code></pre></div></div>
<p>Registers a function that is called at the end of a tribe’s turn. See <code class="language-plaintext highlighter-rouge">onTurn</code> for interaction with other “turn” triggers.</p>
<h3 id="onturn">
  
  
    onTurn <a href="#onturn"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onTurn(code: fun(turn: integer))
</code></pre></div></div>
<p>Registers a function that is called at the start of a turn. The basic sequence of this and other “turn” triggers is as follows:
<br /><code class="language-plaintext highlighter-rouge">onTurn</code> fires
<br />Non-tribe-specific updates take place
<br /><code class="language-plaintext highlighter-rouge">onTribeTurnBegin</code> fires for tribe 0.
<br />Tribe 0 cities are processed.
<br /><code class="language-plaintext highlighter-rouge">onCityProcessingComplete</code> fires for tribe 0 (this fires even when a tribe has no cities).
<br />Tribe 0 units move
<br /><code class="language-plaintext highlighter-rouge">onTribeTurnEnd</code> fires for tribe 0.
<br />All active tribes are processed in order according to the sequence for tribe 0
<br /><code class="language-plaintext highlighter-rouge">onTribeTurnEnd</code> fires for tribe 7.
<br /><code class="language-plaintext highlighter-rouge">onTurn</code> fires for the next turn</p>
<h3 id="onunitkilled">
  
  
    onUnitKilled <a href="#onunitkilled"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onUnitKilled(code: fun(loser: unitObject, winner: unitObject))
</code></pre></div></div>
<p>Registers a function that is called whenever a unit is killed. <code class="language-plaintext highlighter-rouge">loser</code> is the unit that is killed, <code class="language-plaintext highlighter-rouge">winner</code> is the unit responsible for it.</p>
<h3 id="onusenuclearweapon">
  
  
    onUseNuclearWeapon <a href="#onusenuclearweapon"><span class="self-link">&#128279</span></a>
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onUseNuclearWeapon(code: fun(unit: unitObject, tile: tileObject):(attackProceeds: boolean))
</code></pre></div></div>
<p>Registers a function that is called when a nuclear weapon is used. This is also called when a spy plants a nuclear device in a city. <code class="language-plaintext highlighter-rouge">unit</code> is the weapon or the spy unit, <code class="language-plaintext highlighter-rouge">tile</code> is the location of the attack. Return <code class="language-plaintext highlighter-rouge">false</code> to abort the attack, <code class="language-plaintext highlighter-rouge">true</code> to proceed.</p>

  </div>
</article>
<!--
    <h1 id="civ">
  
  
    <a href="#civ">&#128279</a> civ
  
  
</h1>
    

<p>The civ module provides functions which can interact directly with the game.  It is always in scope, so you never need to use a <code class="language-plaintext highlighter-rouge">require</code> call in order to access it.</p>
<h2 id="civ-1">
  
  
    <a href="#civ-1">&#128279</a> civ
  
  
</h2>
    
<h3 id="addimprovement">
  
  
    <a href="#addimprovement">&#128279</a> addImprovement
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.addImprovement(city: cityObject, improvement: improvementObject)
</code></pre></div></div>
<p>Adds city improvement <code class="language-plaintext highlighter-rouge">improvement</code> to city <code class="language-plaintext highlighter-rouge">city</code>.</p>
<h3 id="canenter">
  
  
    <a href="#canenter">&#128279</a> canEnter
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.canEnter(unitType: unitTypeObject, tile: tileObject)
  -&gt; boolean: boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if the given unittype can enter tile <code class="language-plaintext highlighter-rouge">tile</code>, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>
<h3 id="capturecity">
  
  
    <a href="#capturecity">&#128279</a> captureCity
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.captureCity(city: cityObject, tribe: tribeObject)
</code></pre></div></div>
<p>Captures city <code class="language-plaintext highlighter-rouge">city</code> for tribe <code class="language-plaintext highlighter-rouge">tribe</code>.</p>
<h3 id="createcity">
  
  
    <a href="#createcity">&#128279</a> createCity
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.createCity(tribe: tribeObject, tile: tileObject)
  -&gt; city: cityObject|nil
</code></pre></div></div>
<p>Creates a city owned by <code class="language-plaintext highlighter-rouge">tribe</code> at the location given by <code class="language-plaintext highlighter-rouge">tile</code>. Returns <code class="language-plaintext highlighter-rouge">nil</code> if a city could not be created.</p>
<h3 id="createunit">
  
  
    <a href="#createunit">&#128279</a> createUnit
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.createUnit(unitType: unitTypeObject, tribe: tribeObject, tile: tileObject)
  -&gt; unit: unitObject
</code></pre></div></div>
<p>Creates a unit of type <code class="language-plaintext highlighter-rouge">unittype</code>, owned by <code class="language-plaintext highlighter-rouge">tribe</code>, at the location given by <code class="language-plaintext highlighter-rouge">tile</code>.</p>
<h3 id="deletecity">
  
  
    <a href="#deletecity">&#128279</a> deleteCity
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.deleteCity(city: cityObject)
</code></pre></div></div>
<p>Deletes city <code class="language-plaintext highlighter-rouge">city</code> from the game.</p>
<h3 id="deleteunit">
  
  
    <a href="#deleteunit">&#128279</a> deleteUnit
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.deleteUnit(unit: unitObject)
</code></pre></div></div>
<p>Deletes unit <code class="language-plaintext highlighter-rouge">unit</code> from the game.
Consider unsing <code class="language-plaintext highlighter-rouge">gen.defeatUnit</code>, <code class="language-plaintext highlighter-rouge">gen.killUnit</code>, <code class="language-plaintext highlighter-rouge">gen.deleteUnit</code>, or <code class="language-plaintext highlighter-rouge">gen.replaceUnit</code> instead, for event integration.
<br />Deprecation flag is only here so that designers see the above notice.</p>
<h3 id="destroywonder">
  
  
    <a href="#destroywonder">&#128279</a> destroyWonder
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.destroyWonder(wonder: wonderObject)
</code></pre></div></div>
<p>Destroys wonder <code class="language-plaintext highlighter-rouge">wonder</code>, removing it from the game, and marking it as ‘lost’.</p>
<h3 id="enabletechgroup">
  
  
    <a href="#enabletechgroup">&#128279</a> enableTechGroup
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.enableTechGroup(tribe: tribeObject, techgroup: integer, value: 0|1|2)
</code></pre></div></div>
<p>Sets the value of tech group <code class="language-plaintext highlighter-rouge">techgroup</code> (0-7) to value <code class="language-plaintext highlighter-rouge">value</code> (0-2, 0 = can research, can own, 1 = can’t research, can own, 2 = can’t research, can’t own) for tribe <code class="language-plaintext highlighter-rouge">tribe</code>.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">techgroup</code> — integer in [0,7]</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">value</span><span class="p">:</span>
    <span class="err">\|</span> <span class="mi">0</span> <span class="c1">-- can research, can own</span>
    <span class="err">\|</span> <span class="mi">1</span> <span class="c1">-- can't research, can own</span>
    <span class="err">\|</span> <span class="mi">2</span> <span class="c1">-- can't research, can't own</span>
</code></pre></div></div>
<h3 id="endgame">
  
  
    <a href="#endgame">&#128279</a> endGame
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.endGame(endscreens: boolean)
</code></pre></div></div>
<p>Ends the game. <code class="language-plaintext highlighter-rouge">endscreens</code> is a boolean that determines whether to show the powergraph and related screens.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">endscreens</code> — This argument is false by default.</p>
<h3 id="getactiveunit">
  
  
    <a href="#getactiveunit">&#128279</a> getActiveUnit
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getActiveUnit()
  -&gt; unit: unitObject
</code></pre></div></div>
<p>Returns the currently active unit.</p>
<h3 id="getatlasdimensions">
  
  
    <a href="#getatlasdimensions">&#128279</a> getAtlasDimensions
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getAtlasDimensions()
  -&gt; width: integer
  2. height: integer
  3. number_of_maps: integer
</code></pre></div></div>
<p>Returns three integers, the width and height of the map and the number of maps.</p>
<h3 id="getbaseterrain">
  
  
    <a href="#getbaseterrain">&#128279</a> getBaseTerrain
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getBaseTerrain(map: integer|mapObject, terrainId: integer)
  -&gt; baseTerrain: baseTerrainObject
</code></pre></div></div>
<p>Returns the base terrain object for the given map and terrain type.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">map</code> — The map for the base terrain type we want, or its id.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">terrainId</code> — The id number of the base terrain type sought</p>
<h3 id="getcity">
  
  
    <a href="#getcity">&#128279</a> getCity
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getCity(id: integer)
  -&gt; city: cityObject|nil
</code></pre></div></div>
<p>Returns the city with id <code class="language-plaintext highlighter-rouge">id</code>, or <code class="language-plaintext highlighter-rouge">nil</code> if it doesn’t exist.</p>
<h3 id="getcommodity">
  
  
    <a href="#getcommodity">&#128279</a> getCommodity
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getCommodity(id: integer)
  -&gt; commodity: commodityObject|nil
</code></pre></div></div>
<p>Returns the commodity with id <code class="language-plaintext highlighter-rouge">id</code> (0-15 for regular commodities, -1 for food supplies), or <code class="language-plaintext highlighter-rouge">nil</code> if it doesn’t exist.</p>
<h3 id="getcurrenttile">
  
  
    <a href="#getcurrenttile">&#128279</a> getCurrentTile
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getCurrentTile()
  -&gt; tile: tileObject
</code></pre></div></div>
<p>Returns the currently selected tile.</p>
<h3 id="getcurrenttribe">
  
  
    <a href="#getcurrenttribe">&#128279</a> getCurrentTribe
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getCurrentTribe()
  -&gt; tribe: tribeObject
</code></pre></div></div>
<p>Returns the currently active tribe.</p>
<h3 id="getgameyear">
  
  
    <a href="#getgameyear">&#128279</a> getGameYear
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getGameYear()
  -&gt; integer: integer
</code></pre></div></div>
<p>Returns the current game year.</p>
<h3 id="getimprovement">
  
  
    <a href="#getimprovement">&#128279</a> getImprovement
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getImprovement(id: integer)
  -&gt; improvement: improvementObject|nil
</code></pre></div></div>
<p>Returns the improvement with id <code class="language-plaintext highlighter-rouge">id</code> (0-39), or <code class="language-plaintext highlighter-rouge">nil</code> if it doesn’t exist.</p>
<h3 id="getmap">
  
  
    <a href="#getmap">&#128279</a> getMap
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getMap(id: integer)
  -&gt; map: mapObject|nil
</code></pre></div></div>
<p>Returns the map with id <code class="language-plaintext highlighter-rouge">id</code> (0-3) or <code class="language-plaintext highlighter-rouge">nil</code> if it doesn’t exist.</p>
<h3 id="getmapdimensions">
  
  
    <a href="#getmapdimensions">&#128279</a> getMapDimensions
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getMapDimensions()
  -&gt; width: integer
  2. height: integer
  3. number_of_maps: integer
</code></pre></div></div>
<p>Alias for getAtlasDimensions. (deprecated since 0.16)</p>
<h3 id="getopencity">
  
  
    <a href="#getopencity">&#128279</a> getOpenCity
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getOpenCity()
  -&gt; city: cityObject|nil
</code></pre></div></div>
<p>Returns the city currently opened in the city window, <code class="language-plaintext highlighter-rouge">nil</code> if the city window is closed.</p>
<h3 id="getplayertribe">
  
  
    <a href="#getplayertribe">&#128279</a> getPlayerTribe
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getPlayerTribe()
  -&gt; tribe: tribeObject
</code></pre></div></div>
<p>Returns the player’s tribe.</p>
<h3 id="gettech">
  
  
    <a href="#gettech">&#128279</a> getTech
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getTech(id: integer)
  -&gt; tech: techObject|nil
</code></pre></div></div>
<p>Returns the tech with id <code class="language-plaintext highlighter-rouge">id</code> (0-99), or <code class="language-plaintext highlighter-rouge">nil</code> if it doesn’t exist.</p>
<h3 id="getterrain">
  
  
    <a href="#getterrain">&#128279</a> getTerrain
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getTerrain(map: integer|mapObject, terrainId: integer, resource: 0|1|2)
  -&gt; terrain: terrainObject
</code></pre></div></div>
<p>Returns the terrain object for the given map, terrain type and resource. Out of bound id’s cause errors.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">map</code> — The map for the terrain we want, or its id.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">terrainId</code> — The id number of the base terrain type sought.</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">resource</span><span class="p">:</span>
    <span class="err">\|</span> <span class="mi">0</span> <span class="c1">-- no resource</span>
    <span class="err">\|</span> <span class="mi">1</span> <span class="c1">-- fish resource</span>
    <span class="err">\|</span> <span class="mi">2</span> <span class="c1">-- whales resource</span>
</code></pre></div></div>
<h3 id="gettile">
  
  
    <a href="#gettile">&#128279</a> getTile
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getTile(x: integer, y: integer, z: integer)
  -&gt; tile: tileObject|nil
</code></pre></div></div>
<p>Returns the tile with coordinates <code class="language-plaintext highlighter-rouge">x</code>, <code class="language-plaintext highlighter-rouge">y</code>, <code class="language-plaintext highlighter-rouge">z</code>, or <code class="language-plaintext highlighter-rouge">nil</code> if it doesn’t exist.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">x</code> — the ‘x’ coordinate of the tile</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">y</code> — the ‘y’ coordinate of the tile</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">z</code> — the ‘z’ coordinate of the tile ([0,3])</p>
<h3 id="gettotdir">
  
  
    <a href="#gettotdir">&#128279</a> getToTDir
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getToTDir()
  -&gt; string
</code></pre></div></div>
<p>Returns the absolute path of the ToT installation directory.</p>

<p>@<em>return</em> —</p>
<h3 id="gettribe">
  
  
    <a href="#gettribe">&#128279</a> getTribe
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getTribe(id: integer)
  -&gt; tribe: tribeObject|nil
</code></pre></div></div>
<p>Returns the tribe with id <code class="language-plaintext highlighter-rouge">id</code> (0-7), or <code class="language-plaintext highlighter-rouge">nil</code> if it doesn’t exist.</p>
<h3 id="getturn">
  
  
    <a href="#getturn">&#128279</a> getTurn
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getTurn()
  -&gt; integer
</code></pre></div></div>
<p>Returns the current turn number.</p>

<p>@<em>return</em> —</p>
<h3 id="getunit">
  
  
    <a href="#getunit">&#128279</a> getUnit
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getUnit(id: integer)
  -&gt; unit: unitObject|nil
</code></pre></div></div>
<p>Returns the unit with id <code class="language-plaintext highlighter-rouge">id</code>, or <code class="language-plaintext highlighter-rouge">nil</code> if it doesn’t exist.</p>
<h3 id="getunittype">
  
  
    <a href="#getunittype">&#128279</a> getUnitType
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getUnitType(id: integer)
  -&gt; unitType: unitTypeObject|nil
</code></pre></div></div>
<p>Returns the unit type with id <code class="language-plaintext highlighter-rouge">id</code>, or <code class="language-plaintext highlighter-rouge">nil</code> if it doesn’t exist.</p>
<h3 id="getwonder">
  
  
    <a href="#getwonder">&#128279</a> getWonder
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.getWonder(id: integer)
  -&gt; wonder: wonderObject|nil
</code></pre></div></div>
<p>Returns the wonder with id <code class="language-plaintext highlighter-rouge">id</code> (0-27), or <code class="language-plaintext highlighter-rouge">nil</code> if it doesn’t exist.</p>
<h3 id="givetech">
  
  
    <a href="#givetech">&#128279</a> giveTech
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.giveTech(tribe: tribeObject, tech: techObject)
</code></pre></div></div>
<p>Gives tech <code class="language-plaintext highlighter-rouge">tech</code> to tribe <code class="language-plaintext highlighter-rouge">tribe</code>.</p>
<h3 id="hasimprovement">
  
  
    <a href="#hasimprovement">&#128279</a> hasImprovement
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.hasImprovement(city: cityObject, improvement: improvementObject)
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if city <code class="language-plaintext highlighter-rouge">city</code> has improvement <code class="language-plaintext highlighter-rouge">improvement</code>, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>
<h3 id="hastech">
  
  
    <a href="#hastech">&#128279</a> hasTech
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.hasTech(tribe: tribeObject, tech: techObject)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if tribe <code class="language-plaintext highlighter-rouge">tribe</code> has tech <code class="language-plaintext highlighter-rouge">tech</code>, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="isbaseterrain">
  
  
    <a href="#isbaseterrain">&#128279</a> isBaseTerrain
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isBaseTerrain(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a base terrain, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="iscity">
  
  
    <a href="#iscity">&#128279</a> isCity
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isCity(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a city, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="isdialog">
  
  
    <a href="#isdialog">&#128279</a> isDialog
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isDialog(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a dialog, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="isimage">
  
  
    <a href="#isimage">&#128279</a> isImage
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isImage(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is an image, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="isimprovement">
  
  
    <a href="#isimprovement">&#128279</a> isImprovement
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isImprovement(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a city improvement, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="isleader">
  
  
    <a href="#isleader">&#128279</a> isLeader
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isLeader(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a leader, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="ismap">
  
  
    <a href="#ismap">&#128279</a> isMap
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isMap(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a map, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="istech">
  
  
    <a href="#istech">&#128279</a> isTech
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isTech(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a tech, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="isterrain">
  
  
    <a href="#isterrain">&#128279</a> isTerrain
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isTerrain(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a terrain, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="istile">
  
  
    <a href="#istile">&#128279</a> isTile
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isTile(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a tile, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="istraderoute">
  
  
    <a href="#istraderoute">&#128279</a> isTradeRoute
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isTradeRoute(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a trade route, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="istribe">
  
  
    <a href="#istribe">&#128279</a> isTribe
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isTribe(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a tribe, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="isunit">
  
  
    <a href="#isunit">&#128279</a> isUnit
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isUnit(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a unit, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="isunittype">
  
  
    <a href="#isunittype">&#128279</a> isUnitType
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isUnitType(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a unit type, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="iswonder">
  
  
    <a href="#iswonder">&#128279</a> isWonder
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.isWonder(object: any)
  -&gt; boolean
</code></pre></div></div>
<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">object</code> is a wonder, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>

<p>@<em>return</em> —</p>
<h3 id="iteratecities">
  
  
    <a href="#iteratecities">&#128279</a> iterateCities
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.iterateCities()
  -&gt; fun():cityObject
</code></pre></div></div>
<p>Returns an iterator yielding all cities in the game.</p>

<p>@<em>return</em> —</p>
<h3 id="iterateunits">
  
  
    <a href="#iterateunits">&#128279</a> iterateUnits
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.iterateUnits()
  -&gt; fun():unitObject
</code></pre></div></div>
<p>Returns an iterator yielding all units in the game.</p>

<p>@<em>return</em> —</p>
<h3 id="killtribe">
  
  
    <a href="#killtribe">&#128279</a> killTribe
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.killTribe(tribe: tribeObject)
</code></pre></div></div>
<p>Removes tribe <code class="language-plaintext highlighter-rouge">tribe</code> from the game. All its cities and units are removed.</p>
<h3 id="makeaggression">
  
  
    <a href="#makeaggression">&#128279</a> makeAggression
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.makeAggression(who: tribeObject, whom: tribeObject)
</code></pre></div></div>
<p>Cancels any peace treaties between tribe <code class="language-plaintext highlighter-rouge">who</code> and tribe <code class="language-plaintext highlighter-rouge">whom</code>, and make <code class="language-plaintext highlighter-rouge">who</code> declare war on <code class="language-plaintext highlighter-rouge">whom</code>.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">who</code> — The tribe declaring war.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">whom</code> — The tribe not declaring war.</p>
<h3 id="playmusic">
  
  
    <a href="#playmusic">&#128279</a> playMusic
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.playMusic(trackOrFilename: string|integer)
</code></pre></div></div>
<p>Plays CD track <code class="language-plaintext highlighter-rouge">trackNo</code>, or with the DirectShow music patch enabled, play the file given by <code class="language-plaintext highlighter-rouge">filename</code>, where <code class="language-plaintext highlighter-rouge">filename</code> is relative to the ‘Music’ directory.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">trackOrFilename</code> — Track number of cd or filename of music.</p>
<h3 id="playsound">
  
  
    <a href="#playsound">&#128279</a> playSound
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.playSound(filename: string)
</code></pre></div></div>
<p>Plays the sound file given by <code class="language-plaintext highlighter-rouge">filename</code>.</p>
<h3 id="playvideo">
  
  
    <a href="#playvideo">&#128279</a> playVideo
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.playVideo(filename: string)
</code></pre></div></div>
<p>Plays the video file given by <code class="language-plaintext highlighter-rouge">filename</code>.</p>
<h3 id="removeimprovement">
  
  
    <a href="#removeimprovement">&#128279</a> removeImprovement
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.removeImprovement(city: cityObject, improvement: improvementObject)
</code></pre></div></div>
<p>Removes city improvement <code class="language-plaintext highlighter-rouge">improvement</code> from city <code class="language-plaintext highlighter-rouge">city</code>.</p>
<h3 id="sleep">
  
  
    <a href="#sleep">&#128279</a> sleep
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.sleep(milliseconds: integer)
</code></pre></div></div>
<p>Sleeps for the given number of milliseconds.</p>
<h3 id="taketech">
  
  
    <a href="#taketech">&#128279</a> takeTech
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.takeTech(tribe: tribeObject, tech: techObject, collapse?: boolean)
</code></pre></div></div>
<p>Takes away tech <code class="language-plaintext highlighter-rouge">tech</code> from tribe <code class="language-plaintext highlighter-rouge">tribe</code>, the optional <code class="language-plaintext highlighter-rouge">collapse</code> parameter determines whether to take away all techs that have <code class="language-plaintext highlighter-rouge">tech</code> as a prerequisite somewhere up the tree.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">collapse</code> — false by default</p>
<h3 id="teleportunit">
  
  
    <a href="#teleportunit">&#128279</a> teleportUnit
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.teleportUnit(unit: unitObject, tile: tileObject)
</code></pre></div></div>
<p>Teleports (i.e. moves at no cost) unit <code class="language-plaintext highlighter-rouge">unit</code> to tile <code class="language-plaintext highlighter-rouge">tile</code>. The unit is moved regardless of whether it is a valid location for the unit. To check this, see <code class="language-plaintext highlighter-rouge">civ.canEnter</code> and <code class="language-plaintext highlighter-rouge">civlua.isValidUnitLocation</code>.</p>
<h2 id="civui">
  
  
    <a href="#civui">&#128279</a> civ.ui
  
  
</h2>
    
<h3 id="centerview">
  
  
    <a href="#centerview">&#128279</a> centerView
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.ui.centerView(tile: tileObject)
</code></pre></div></div>
<p>Centers the map on the given tile.</p>
<h3 id="createdialog">
  
  
    <a href="#createdialog">&#128279</a> createDialog
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.ui.createDialog()
  -&gt; dialog: dialogObject
</code></pre></div></div>
<p>Creates and initializes a dialog. See the dialog section for more details.</p>
<h3 id="loadimage">
  
  
    <a href="#loadimage">&#128279</a> loadImage
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.ui.loadImage(filename: string, x: integer, y: integer, width: integer, height: integer)
  -&gt; image: imageObject
</code></pre></div></div>
<p>Loads an image (BMP or GIF) from <code class="language-plaintext highlighter-rouge">filename</code>. Optionally accepts <code class="language-plaintext highlighter-rouge">x</code>, <code class="language-plaintext highlighter-rouge">y</code>, <code class="language-plaintext highlighter-rouge">width</code> and <code class="language-plaintext highlighter-rouge">height</code> to load part of the image.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">x</code> — pixel (x,y) is the top left corner of sub image</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">y</code> — pixel (x,y) is the top left corner of sub image</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">width</code> — width of sub image</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">height</code> — height of sub image</p>
<h3 id="loadterrain">
  
  
    <a href="#loadterrain">&#128279</a> loadTerrain
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.ui.loadTerrain(map: integer|mapObject, filename1: string, filename2: string)
</code></pre></div></div>
<p>Replaces terrain graphics for map number <code class="language-plaintext highlighter-rouge">map</code>, loading graphics from <code class="language-plaintext highlighter-rouge">filename1</code> (corresponding to “TERRAIN1.BMP”) and <code class="language-plaintext highlighter-rouge">filename2</code> (corresponding to “TERRAIN2.BMP”)</p>
<h3 id="redrawmap">
  
  
    <a href="#redrawmap">&#128279</a> redrawMap
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.ui.redrawMap()
</code></pre></div></div>
<p>Redraws the entire map.</p>
<h3 id="redrawtile">
  
  
    <a href="#redrawtile">&#128279</a> redrawTile
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.ui.redrawTile(tile: tileObject)
</code></pre></div></div>
<p>Redraws the given tile.</p>
<h3 id="setzoom">
  
  
    <a href="#setzoom">&#128279</a> setZoom
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.ui.setZoom(integer: integer)
</code></pre></div></div>
<p>Sets the zoom level (range from -7 (max zoom out) to 8 (max zoom in)).</p>
<h3 id="text">
  
  
    <a href="#text">&#128279</a> text
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.ui.text(string: string, ...string)
</code></pre></div></div>
<p>Display a pop-up text box with the given string as text.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">string</code> — text to show in a text box</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">...</code> — more text</p>
<h3 id="zoomin">
  
  
    <a href="#zoomin">&#128279</a> zoomIn
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.ui.zoomIn()
</code></pre></div></div>
<p>Zooms in on the map (increases zoom level by 1).</p>
<h3 id="zoomout">
  
  
    <a href="#zoomout">&#128279</a> zoomOut
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.ui.zoomOut()
</code></pre></div></div>
<p>Zooms out of the map (decreases zoom level by 1).</p>
<h2 id="civcosmic">
  
  
    <a href="#civcosmic">&#128279</a> civ.cosmic
  
  
</h2>
    
<h3 id="communismpalacedistance">
  
  
    <a href="#communismpalacedistance">&#128279</a> communismPalaceDistance
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.communismPalaceDistance --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the distance from palace used in happiness calculations under Communism.</p>
<h3 id="foodeaten">
  
  
    <a href="#foodeaten">&#128279</a> foodEaten
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.foodEaten --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the amount of food eaten by each citizen each turn.</p>
<h3 id="foodrows">
  
  
    <a href="#foodrows">&#128279</a> foodRows
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.foodRows --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the number of rows in the food box.</p>
<h3 id="goodiehutsmask">
  
  
    <a href="#goodiehutsmask">&#128279</a> goodieHutsMask
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.goodieHutsMask --&gt; bitmask
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the bitmask for goodie huts.</p>
<h3 id="helispickuphuts">
  
  
    <a href="#helispickuphuts">&#128279</a> helisPickupHuts
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.helisPickupHuts --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns whether helicopters (domain 1, range 0 units) pick up huts or not.</p>
<h3 id="massthrustparadigm">
  
  
    <a href="#massthrustparadigm">&#128279</a> massThrustParadigm
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.massThrustParadigm --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the mass/thrust paradigm.</p>
<h3 id="numberofunittypes">
  
  
    <a href="#numberofunittypes">&#128279</a> numberOfUnitTypes
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.numberOfUnitTypes --&gt; integer
</code></pre></div></div>
<p>(get) Returns the number of unit types from the @COSMIC2 key of the same name.</p>
<h3 id="paradroprange">
  
  
    <a href="#paradroprange">&#128279</a> paradropRange
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.paradropRange --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the maximum paradrop range.</p>
<h3 id="penaltybetrayal">
  
  
    <a href="#penaltybetrayal">&#128279</a> penaltyBetrayal
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.penaltyBetrayal --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the penalty to the civilization score for each betrayal of another tribe.</p>
<h3 id="prodchangepenalty">
  
  
    <a href="#prodchangepenalty">&#128279</a> prodChangePenalty
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.prodChangePenalty --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the shield penalty percentage for changing production types.</p>
<h3 id="riotfactor">
  
  
    <a href="#riotfactor">&#128279</a> riotFactor
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.riotFactor --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the riot factor based on the number of cities.</p>
<h3 id="roadmultiplier">
  
  
    <a href="#roadmultiplier">&#128279</a> roadMultiplier
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.roadMultiplier --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the road movement multiplier.</p>
<h3 id="sciencelostfundamentalism">
  
  
    <a href="#sciencelostfundamentalism">&#128279</a> scienceLostFundamentalism
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.scienceLostFundamentalism --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the percentage of science lost under Fundamentalism.</p>
<h3 id="scienceratefundamentalism">
  
  
    <a href="#scienceratefundamentalism">&#128279</a> scienceRateFundamentalism
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.scienceRateFundamentalism --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the maximum effective science rate under Fundamentalism.</p>
<h3 id="scorecentauri">
  
  
    <a href="#scorecentauri">&#128279</a> scoreCentauri
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.scoreCentauri --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the civilization score for each landing on Alpha Centauri first. Multiplied by number of habitats and success probability.</p>
<h3 id="scorecitizen">
  
  
    <a href="#scorecitizen">&#128279</a> scoreCitizen
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.scoreCitizen --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the civilization score for each citizen.</p>
<h3 id="scorefuturetech">
  
  
    <a href="#scorefuturetech">&#128279</a> scoreFutureTech
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.scoreFutureTech --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the civilization score for each future technology researched.</p>
<h3 id="scorepeace">
  
  
    <a href="#scorepeace">&#128279</a> scorePeace
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.scorePeace --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the civilization score for each turn of peace after turn 199.</p>
<h3 id="scorepollution">
  
  
    <a href="#scorepollution">&#128279</a> scorePollution
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.scorePollution --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the civilization score for each extant non-AI controlled polluted tile. Normally a negative value, i.e. a penalty.</p>
<h3 id="scoreunitkilled">
  
  
    <a href="#scoreunitkilled">&#128279</a> scoreUnitKilled
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.scoreUnitKilled --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the civilization score for each unit killed.</p>
<h3 id="scorewonder">
  
  
    <a href="#scorewonder">&#128279</a> scoreWonder
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.scoreWonder --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the civilization score for each wonder.</p>
<h3 id="settlerseathigh">
  
  
    <a href="#settlerseathigh">&#128279</a> settlersEatHigh
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.settlersEatHigh --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the amount of food eaten by settlers for governments ≥ Communism.</p>
<h3 id="settlerseatlow">
  
  
    <a href="#settlerseatlow">&#128279</a> settlersEatLow
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.settlersEatLow --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the amount of food eaten by settlers for governments ≤ Monarchy.</p>
<h3 id="shieldrows">
  
  
    <a href="#shieldrows">&#128279</a> shieldRows
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.shieldRows --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the number of rows in the shield box.</p>
<h3 id="sizeaquaduct">
  
  
    <a href="#sizeaquaduct">&#128279</a> sizeAquaduct
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.sizeAquaduct --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the city size that cannot be exceeded without an Aquaduct.</p>
<h3 id="sizesewer">
  
  
    <a href="#sizesewer">&#128279</a> sizeSewer
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.sizeSewer --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the city size that cannot be exceeded without a Sewer System.</p>
<h3 id="sizeunhappiness">
  
  
    <a href="#sizeunhappiness">&#128279</a> sizeUnhappiness
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.sizeUnhappiness --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the city size at which the first unhappy citizen appears at Chieftain difficulty.</p>
<h3 id="supportcommunism">
  
  
    <a href="#supportcommunism">&#128279</a> supportCommunism
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.supportCommunism --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the number of units that are free of support under Communism.</p>
<h3 id="supportfundamentalism">
  
  
    <a href="#supportfundamentalism">&#128279</a> supportFundamentalism
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.supportFundamentalism --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the number of units that are free of support costs under Fundamentalism.</p>
<h3 id="supportmonarchy">
  
  
    <a href="#supportmonarchy">&#128279</a> supportMonarchy
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.supportMonarchy --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the number of units that are free of support under Monarchy.</p>
<h3 id="techparadigm">
  
  
    <a href="#techparadigm">&#128279</a> techParadigm
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.techParadigm --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the tech paradigm. Scenarios use civ.scen.params.techParadigm instead of this value.</p>
<h3 id="transformbase">
  
  
    <a href="#transformbase">&#128279</a> transformBase
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.transformBase --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the base time needed for engineers to transform terrain.</p>
<h3 id="triremelost">
  
  
    <a href="#triremelost">&#128279</a> triremeLost
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.cosmic.triremeLost --&gt; integer
</code></pre></div></div>
<p>(get/set - ephemeral) Returns the 1 in x chance of a trireme getting lost at sea.</p>
<h2 id="civgame">
  
  
    <a href="#civgame">&#128279</a> civ.game
  
  
</h2>
    
<h3 id="activetribes">
  
  
    <a href="#activetribes">&#128279</a> activeTribes
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.game.activeTribes --&gt; bitmask
</code></pre></div></div>
<p>(get/set) Returns the active tribe mask.</p>
<h3 id="barbarianactivity">
  
  
    <a href="#barbarianactivity">&#128279</a> barbarianActivity
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.game.barbarianActivity --&gt; integer
</code></pre></div></div>
<p>(get/set) Returns the level of barbarian activity.</p>
<h3 id="difficulty">
  
  
    <a href="#difficulty">&#128279</a> difficulty
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.game.difficulty --&gt; integer
</code></pre></div></div>
<p>(get/set) Returns the difficulty level.</p>
<h3 id="gameyear">
  
  
    <a href="#gameyear">&#128279</a> gameYear
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.game.gameYear --&gt; integer
</code></pre></div></div>
<p>(get/set) Returns the game year, or for scenarios with monthly increments, the number of months * 12.</p>
<h3 id="humanplayers">
  
  
    <a href="#humanplayers">&#128279</a> humanPlayers
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.game.humanPlayers --&gt; bitmask
</code></pre></div></div>
<p>(get/set) Returns the human players mask.</p>
<h3 id="humantribe">
  
  
    <a href="#humantribe">&#128279</a> humanTribe
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.game.humanTribe --&gt; tribeObject
</code></pre></div></div>
<p>(get) Returns the last active human tribe.</p>
<h3 id="peaceturns">
  
  
    <a href="#peaceturns">&#128279</a> peaceTurns
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.game.peaceTurns --&gt; integer
</code></pre></div></div>
<p>(get/set) Returns the number of turns of peace.</p>
<h3 id="revealmap">
  
  
    <a href="#revealmap">&#128279</a> revealMap
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.game.revealMap --&gt; boolean
</code></pre></div></div>
<p>(get/set) Returns whether or not the full map is revealed.</p>
<h3 id="turnselapsed">
  
  
    <a href="#turnselapsed">&#128279</a> turnsElapsed
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.game.turnsElapsed --&gt; integer
</code></pre></div></div>
<p>(get/set) Returns the number of turns elapsed.</p>
<h2 id="civgamerules">
  
  
    <a href="#civgamerules">&#128279</a> civ.game.rules
  
  
</h2>
    
<h3 id="flatworld">
  
  
    <a href="#flatworld">&#128279</a> flatWorld
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.game.rules.flatWorld --&gt; boolean
</code></pre></div></div>
<p>(get/set) Returns <code class="language-plaintext highlighter-rouge">true</code> if the world map is flat, <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>
<h2 id="civscenparams">
  
  
    <a href="#civscenparams">&#128279</a> civ.scen.params
  
  
</h2>
    
<h3 id="decisivedefeat">
  
  
    <a href="#decisivedefeat">&#128279</a> decisiveDefeat
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.scen.params.decisiveDefeat --&gt; integer
</code></pre></div></div>
<p>(get/set) Number of objectives required for a decisive defeat.</p>
<h3 id="decisivevictory">
  
  
    <a href="#decisivevictory">&#128279</a> decisiveVictory
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.scen.params.decisiveVictory --&gt; integer
</code></pre></div></div>
<p>(get/set) Number of objectives required for a decisive victory.</p>
<h3 id="flags">
  
  
    <a href="#flags">&#128279</a> flags
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.scen.params.flags --&gt; bitmask
</code></pre></div></div>
<p>(get/set) Bitmask representing scenario flags:<br /> <br />00000000 00000001 Total war <br />00000000 00000010 Use objective victory <br />00000000 00000100 Count wonders as objectives <br />00000000 00001000 Reveal cities <br />00000000 00010000 No government change <br />00000000 00100000 No tech conquest <br />00000000 01000000 No pollution <br />00000000 10000000 Terrain animation lockout <br />00000001 00000000 Unit animation lockout <br />00000010 00000000 .SPR file override <br />10000000 00000000 WWII AI</p>
<h3 id="marginaldefeat">
  
  
    <a href="#marginaldefeat">&#128279</a> marginalDefeat
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.scen.params.marginalDefeat --&gt; integer
</code></pre></div></div>
<p>(get/set) Number of objectives required for a marginal defeat.</p>
<h3 id="marginalvictory">
  
  
    <a href="#marginalvictory">&#128279</a> marginalVictory
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.scen.params.marginalVictory --&gt; integer
</code></pre></div></div>
<p>(get/set) Number of objectives required for a marginal victory.</p>
<h3 id="maxturns">
  
  
    <a href="#maxturns">&#128279</a> maxTurns
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.scen.params.maxTurns --&gt; integer
</code></pre></div></div>
<p>(get/set) Maximum number of turns before the scenario ends.</p>
<h3 id="name">
  
  
    <a href="#name">&#128279</a> name
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.scen.params.name --&gt; string
</code></pre></div></div>
<p>(get/set) The name of the scenario.</p>
<h3 id="objectivesprotagonist">
  
  
    <a href="#objectivesprotagonist">&#128279</a> objectivesProtagonist
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.scen.params.objectivesProtagonist --&gt; tribeObject
</code></pre></div></div>
<p>(get/set) Returns the objectives protagonist.</p>
<h3 id="startingyear">
  
  
    <a href="#startingyear">&#128279</a> startingYear
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.scen.params.startingYear --&gt; integer
</code></pre></div></div>
<p>(get) Returns the starting year of the scenario.</p>
<h3 id="techparadigm-1">
  
  
    <a href="#techparadigm-1">&#128279</a> techParadigm
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.scen.params.techParadigm --&gt; integer
</code></pre></div></div>
<p>(get/set) Returns the tech paradigm used by the scenario. Non-scenario games use civ.cosmic.techParadigm instead of this value.</p>
<h3 id="yearincrement">
  
  
    <a href="#yearincrement">&#128279</a> yearIncrement
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.scen.params.yearIncrement --&gt; integer
</code></pre></div></div>
<p>(get/set) Returns the year increment (number of years per turn). Negative for monthly increments.</p>
<h2 id="civscencompatibility">
  
  
    <a href="#civscencompatibility">&#128279</a> civ.scen.compatibility
  
  
</h2>
    
<h3 id="activateuniteverymove">
  
  
    <a href="#activateuniteverymove">&#128279</a> activateUnitEveryMove
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>civ.scen.compatibility.activateUnitEveryMove --&gt; boolean
</code></pre></div></div>
<p>If set to true, onActivateUnit will re-trigger for every tile the active unit moves. Defaults to false, in which case onActivateUnit triggers only once.  In the Lua Scenario Template, this is set to true in LuaParameterFiles\parameters.lua.</p>
<h2 id="civscen">
  
  
    <a href="#civscen">&#128279</a> civ.scen
  
  
</h2>
    
<h3 id="onactivateunit">
  
  
    <a href="#onactivateunit">&#128279</a> onActivateUnit
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onActivateUnit(code: fun(unit: unitObject, source: boolean, repeatMove: boolean))
</code></pre></div></div>
<p>Registers a function to be called every time a unit is activated. The callback takes the unit activated as a parameter, and the source of unit activation. <code class="language-plaintext highlighter-rouge">source</code> is <code class="language-plaintext highlighter-rouge">true</code> if activated by keyboard or mouse click, <code class="language-plaintext highlighter-rouge">false</code> if activated by the game itself. <code class="language-plaintext highlighter-rouge">repeatMove</code> is <code class="language-plaintext highlighter-rouge">true</code> if it’s a repeat activation caused by moving (see civ.scen.compatibility), <code class="language-plaintext highlighter-rouge">false</code> otherwise.</p>
<h3 id="onbribeunit">
  
  
    <a href="#onbribeunit">&#128279</a> onBribeUnit
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onBribeUnit(code: fun(unit: unitObject, previousOwner: tribeObject))
</code></pre></div></div>
<p>Registers a function that is called when a unit is bribed successfully. unit.owner is the new owner at this point, <code class="language-plaintext highlighter-rouge">previousOwner</code> the old owner.</p>
<h3 id="oncalculatecityyield">
  
  
    <a href="#oncalculatecityyield">&#128279</a> onCalculateCityYield
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onCalculateCityYield(code: fun(city: cityObject, food: integer, shields: integer, trade: integer):(foodChange: integer, shieldChangeBeforeWaste: integer, shieldChangeAfterWaste: integer, tradeChangeBeforeCor...(too long)...: integer))
</code></pre></div></div>
<p>Registers a function to be called every time a city calculates its total resource yield. Input is the city, and the food, shields and trade of its tiles. Returns a 5-tuple of modifiers, food change, shield change before waste, shield change after waste, trade change before corruption, trade change after corruption. These modifiers are applied at the following points in the calculation:
<br />Calculate yield from all worked tiles
<br />Run onCalculateCityYield
<br />Add foodChange, shieldChangeBeforeWaste and tradeChangeBeforeCorruption
<br />Add changes from food trade routes
<br />Add shields from improvements
<br />Calculate and subtract waste
<br />Calculate corruption and add changes from commodity trade routes
<br />Calculate corruption again (now using the value after trade routes) and subtract.
<br />Add shieldChangeAfterWaste and tradeChangeAfterCorruption
<br />Calculate Tax/Lux/Sci</p>
<h3 id="oncanbuild">
  
  
    <a href="#oncanbuild">&#128279</a> onCanBuild
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onCanBuild(code: fun(defaultBuildFunction: fun(city: cityObject, item: improvementObject|unitTypeObject|wonderObject):(cityCanBuildItemByDefault: boolean, city: cityObject, item: improvementObject|...(too long)...: boolean))
</code></pre></div></div>
<p>Registers a function to be called every time a check is done whether a city can build something or not. It is called for all unit types, improvements and wonders. The first parameter of the callback is the default build function, as implemented by the game. It takes the city and item as parameters. You can call this to produce a result for cases you don’t need to handle yourself. <code class="language-plaintext highlighter-rouge">item</code> can be a unittype, improvement or wonder.
Return <code class="language-plaintext highlighter-rouge">true</code> if <code class="language-plaintext highlighter-rouge">city</code> is allowed to produce <code class="language-plaintext highlighter-rouge">item</code>, <code class="language-plaintext highlighter-rouge">false</code> if not.</p>
<h3 id="oncanfoundcity">
  
  
    <a href="#oncanfoundcity">&#128279</a> onCanFoundCity
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onCanFoundCity(code: fun(unit: unitObject, advancedTribe: boolean):boolean)
</code></pre></div></div>
<p>Registers a function that is called to determine if <code class="language-plaintext highlighter-rouge">unit</code> can found a city at the unit’s location. <code class="language-plaintext highlighter-rouge">advancedTribe</code> is <code class="language-plaintext highlighter-rouge">true</code> when picking up a hut with <code class="language-plaintext highlighter-rouge">unit</code> triggers an advanced tribe. Return <code class="language-plaintext highlighter-rouge">true</code> to allow, <code class="language-plaintext highlighter-rouge">false</code> to disallow.</p>
<h3 id="oncentauriarrival">
  
  
    <a href="#oncentauriarrival">&#128279</a> onCentauriArrival
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onCentauriArrival(code: fun(tribe: tribeObject))
</code></pre></div></div>
<p>Registers a function that is called when a tribe’s spaceship reaches its target. Just registering this function causes the game to not end at this point (“endgame override”).</p>
<h3 id="onchoosedefender">
  
  
    <a href="#onchoosedefender">&#128279</a> onChooseDefender
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onChooseDefender(code: fun(defaultFunction: fun(tile: tileObject, attacker: unitObject):(chosenUnit: unitObject), tile: tileObject, attacker: unitObject, isCombat: boolean):(chosenUnit: unitObject))
</code></pre></div></div>
<p>Registers a function that is called every time a unit is chosen to defend a tile. The first parameter is the default function as implemented by the game. It takes <code class="language-plaintext highlighter-rouge">tile</code> and <code class="language-plaintext highlighter-rouge">attacker</code> as parameters. You can call this to produce a result for cases you don’t need to handle yourself. The second parameter is the tile that’s being considered, the third is the attacking unit, and the fourth, <code class="language-plaintext highlighter-rouge">isCombat</code>, is a boolean that indicates if this invocation will be followed by combat. This function is also called by the AI to determine its goals, in which case <code class="language-plaintext highlighter-rouge">isCombat</code> is false.</p>
<h3 id="oncitydestroyed">
  
  
    <a href="#oncitydestroyed">&#128279</a> onCityDestroyed
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onCityDestroyed(code: fun(city: cityObject))
</code></pre></div></div>
<p>Registers a function that is called when a city is destroyed.</p>
<h3 id="oncityfounded">
  
  
    <a href="#oncityfounded">&#128279</a> onCityFounded
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onCityFounded(code: fun(city: cityObject)|fun(city: cityObject):fun())
</code></pre></div></div>
<p>Registers a function to be called every time a city is founded. The callback takes the city as a parameter, and can optionally return a function (since 0.18) that is called to perform cleanup when the user cancels founding the city.</p>
<h3 id="oncityprocessingcomplete">
  
  
    <a href="#oncityprocessingcomplete">&#128279</a> onCityProcessingComplete
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onCityProcessingComplete(code: fun(turn: integer, tribe: tribeObject))
</code></pre></div></div>
<p>Registers a function that is called when a tribe’s cities have been processed for that turn. See <code class="language-plaintext highlighter-rouge">onTurn</code> for interaction with other “turn” triggers.</p>
<h3 id="oncityproduction">
  
  
    <a href="#oncityproduction">&#128279</a> onCityProduction
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onCityProduction(code: fun(city: cityObject, prod: improvementObject|unitObject|wonderObject))
</code></pre></div></div>
<p>Registers a function that is called when a city completes its production order. The produced item <code class="language-plaintext highlighter-rouge">prod</code> is either a unit, improvement or wonder (this can be checked with the civ.is* functions).</p>
<h3 id="oncitytaken">
  
  
    <a href="#oncitytaken">&#128279</a> onCityTaken
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onCityTaken(code: fun(city: cityObject, defender: tribeObject))
</code></pre></div></div>
<p>Registers a function that is called when a city is captured. <code class="language-plaintext highlighter-rouge">city</code> is the city changing hands, at this point city.owner is the new owner already. <code class="language-plaintext highlighter-rouge">defender</code> is the old owner.</p>
<h3 id="ongameends">
  
  
    <a href="#ongameends">&#128279</a> onGameEnds
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onGameEnds(code: fun(reason: gameEndReasons):(gameIsOver: boolean))
</code></pre></div></div>
<p>Registers a function that is called when the game ends. <code class="language-plaintext highlighter-rouge">reason</code> is an integer between 1 and 6:
<br />1 and 2 - Space race victory. This does not trigger if <code class="language-plaintext highlighter-rouge">onCentauriArrival</code> has a callback registered. 1 means victory by active player.
<br />3 - Conquest victory
<br />4 - Defeat
<br />5 - Retirement
<br />6 - Macro ENDGAME action
<br />Return <code class="language-plaintext highlighter-rouge">true</code> to end the game, <code class="language-plaintext highlighter-rouge">false</code> to keep playing.</p>
<h3 id="ongetformatteddate">
  
  
    <a href="#ongetformatteddate">&#128279</a> onGetFormattedDate
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onGetFormattedDate(code: fun(turn: integer, defaultDateString: string):(displayedDate: string))
</code></pre></div></div>
<p>Registers a function that is called when the game needs to get the date string for a given turn (e.g. “4000 B.C.” for turn 1). <code class="language-plaintext highlighter-rouge">turn</code> is the turn for which the date is requested (not always the current turn), and <code class="language-plaintext highlighter-rouge">defaultDateString</code> is the string as formatted by the game</p>
<h3 id="ongetrushbuycost">
  
  
    <a href="#ongetrushbuycost">&#128279</a> onGetRushBuyCost
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onGetRushBuyCost(code: fun(city: cityObject, defaultCost: integer):(costToComplete: integer))
</code></pre></div></div>
<p>Registers a function that is called when calculating the cost to rush-buy a city’s current production. It takes the city and the cost as calculated by the game as parameters. Returns an integer representing the new costs.</p>
<h3 id="oninitiatecombat">
  
  
    <a href="#oninitiatecombat">&#128279</a> onInitiateCombat
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onInitiateCombat(code: fun(attacker: unitObject, defender: unitObject, attackerDie: integer, attackerPower: integer, defenderDie: integer, defenderPower: integer, isSneakAttack: boolean):thread)
</code></pre></div></div>
<p>Registers a function to be called every time combat is initiated. The callback takes seven parameters, the attacker, the defender, attackerDie (‘die’ as in dice, the attacker’s chance to hit), attackerPower (attacker’s firepower), defenderDie, defenderPower and isSneakAttack. Returns a coroutine that yields every time it wants to process a round, and returns when it wants combat to end. Example:</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">civ</span><span class="p">.</span><span class="n">scen</span><span class="p">.</span><span class="n">onInitiateCombat</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="n">attacker</span><span class="p">,</span> <span class="n">defender</span><span class="p">,</span> <span class="n">attackerDie</span><span class="p">,</span> <span class="n">attackerPower</span><span class="p">,</span> <span class="n">defenderDie</span><span class="p">,</span> <span class="n">defenderPower</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"Attacker's die: 1d"</span> <span class="o">..</span> <span class="n">attackerDie</span> <span class="o">..</span> <span class="s2">", firepower: "</span> <span class="o">..</span> <span class="n">attackerPower</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"Defender's die: 1d"</span> <span class="o">..</span> <span class="n">defenderDie</span> <span class="o">..</span> <span class="s2">", firepower: "</span> <span class="o">..</span> <span class="n">defenderPower</span><span class="p">)</span>
  <span class="k">return</span> <span class="nb">coroutine.create</span><span class="p">(</span><span class="k">function</span> <span class="p">()</span>
    <span class="kd">local</span> <span class="n">round</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">round</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="ow">and</span> <span class="n">attacker</span><span class="p">.</span><span class="n">hitpoints</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">defender</span><span class="p">.</span><span class="n">hitpoints</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">do</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">"Round "</span> <span class="o">..</span> <span class="n">round</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">attacker</span><span class="p">,</span> <span class="n">defender</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">round</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">then</span>
        <span class="n">attacker</span><span class="p">.</span><span class="n">damage</span> <span class="o">=</span> <span class="n">attacker</span><span class="p">.</span><span class="n">damage</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="nb">coroutine.yield</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="n">defender</span><span class="p">)</span> <span class="c1">-- either attacker or defender</span>
      <span class="k">else</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Attack bonus!"</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">coroutine.yield</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="n">attackerDie</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">attackerPower</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">winner</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">attackerRoll</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">defenderRoll</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">reroll</span><span class="p">)</span>
      <span class="k">end</span>
      <span class="n">round</span> <span class="o">=</span> <span class="n">round</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">end</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"End of combat"</span><span class="p">)</span>
  <span class="k">end</span><span class="p">)</span>
<span class="k">end</span><span class="p">)</span>
</code></pre></div></div>

<p>This example shows how to limit combat to five rounds, damages the attacker on even rounds and doubles the attacker’s values on odd rounds.</p>

<p>If the coroutine yields true as its first value, the game’s default combat resolution is skipped for that round and the designer is responsible for updating damage. The second value yielded is either the attacker or the defender, this is used to render animations etc. In this case the coroutine resumes without any values.</p>

<p>If the coroutine yields false as its first value, the game runs its default combat algorithm. The designer can additionally yield modified values for attackerDie, attackerPower, defenderDie and defenderPower (in this order) which will be used by the game for that round. In this case the coroutine resumes with the result of the round, a table containing four values:</p>
<ul>
  <li>winner, this is either attacker or defender.</li>
  <li>attackerRoll, the result of the attacker’s die roll</li>
  <li>defenderRoll, the result of the defender’s die roll</li>
  <li>reroll, true if a reroll happened.</li>
</ul>

<p>This can happen only if the attacker is tribe 0, the defender is a unit guarding a city, and the city is the capital or the tribe has less than 8 cities in total and the attacker’s die roll is higher than the defender’s. A reroll can happen at most once.</p>
<h3 id="onkeypress">
  
  
    <a href="#onkeypress">&#128279</a> onKeyPress
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onKeyPress(code: function)
</code></pre></div></div>
<p>Registers a function to be called every time a key is pressed.</p>

<p>@<em>param</em> <code class="language-plaintext highlighter-rouge">code</code> — (keyCode:integer)</p>
<h3 id="onload">
  
  
    <a href="#onload">&#128279</a> onLoad
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onLoad(code: fun(savedData: string))
</code></pre></div></div>
<p>Registers a function that is called when the game is loaded.</p>
<h3 id="onnegotiation">
  
  
    <a href="#onnegotiation">&#128279</a> onNegotiation
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onNegotiation(code: fun(talker: tribeObject, listener: tribeObject):(canTalk: boolean))
</code></pre></div></div>
<p>Registers a function that is called when two tribes attempt negotiations. <code class="language-plaintext highlighter-rouge">talker</code> is the tribe initiating the contact, <code class="language-plaintext highlighter-rouge">listener</code> the receiver. Return <code class="language-plaintext highlighter-rouge">true</code> to allow the negotiations to commence, <code class="language-plaintext highlighter-rouge">false</code> to deny.</p>
<h3 id="onresolvecombat">
  
  
    <a href="#onresolvecombat">&#128279</a> onResolveCombat
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onResolveCombat(code: fun(defaultResolutionFunction: fun(defender: unitObject, attacker: unitObject):(combatContinues: boolean), defender: unitObject, attacker: unitObject):(combatContinues: boolean))
</code></pre></div></div>
<p>Registers a function to be called during every combat turn. The first parameter of the callback is the default resolution function, as implemented by the game. It takes the attacker and defender as parameters. You can call this to produce a result for cases you don’t need to handle yourself.
Return <code class="language-plaintext highlighter-rouge">true</code> to continue combat, <code class="language-plaintext highlighter-rouge">false</code> to stop.</p>

<p>See onInitiateCombat for replacement.</p>
<h3 id="onsave">
  
  
    <a href="#onsave">&#128279</a> onSave
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onSave(code: fun():(savedData: string))
</code></pre></div></div>
<p>Registers a function that is called when the game is saved.</p>
<h3 id="onscenarioloaded">
  
  
    <a href="#onscenarioloaded">&#128279</a> onScenarioLoaded
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onScenarioLoaded(code: fun())
</code></pre></div></div>
<p>Registers a function that is called when the scenario is loaded.  (This is whenever a game is loaded, not just when the scenario is started.)</p>
<h3 id="onschism">
  
  
    <a href="#onschism">&#128279</a> onSchism
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onSchism(code: fun(tribe: tribeObject):(allowSchism: boolean))
</code></pre></div></div>
<p>Registers a function that is called when a schism is triggered. This happens when the capital of a AI-controlled tribe with more than four cities is captured, and, if the attacker is human-controlled, it is ranked lower in power than the defender. If the attacker is AI-controlled the best human tribe must be ranked lower than the defender for the schism to trigger.
If the schism is allowed, a new tribe will be created that takes over about half the cities of the old tribe. If no new tribe can be created, the schism does not occur.
Return <code class="language-plaintext highlighter-rouge">true</code> to allow the schism to happen, <code class="language-plaintext highlighter-rouge">false</code> to deny.</p>
<h3 id="onselectmusic">
  
  
    <a href="#onselectmusic">&#128279</a> onSelectMusic
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onSelectMusic(code: fun(track: integer|nil):integer|nil)
</code></pre></div></div>
<p>Registers a function that is called when a new music track is to be played. <code class="language-plaintext highlighter-rouge">track</code> is either nil or an integer. If nil, the game wants to play a random track, if not nil it’s either due to the user choosing a track from the menu (first track has id 0), or the game playing one of it’s special tracks (“Funeral March” - track id 0, and “Ode to Joy” - track id 1). To handle special tracks, you can return nil to signal that the game should play the default track associated with that track id. If you want to handle this track id, call civ.playMusic (this will check the Music folder of the scenario first before falling back to the global Music folder) and return an integer, which is used to synchronize the track list in the menu. The track names can be added in @PICKMUSICTOT in Game.txt.</p>
<h3 id="ontribeturnbegin">
  
  
    <a href="#ontribeturnbegin">&#128279</a> onTribeTurnBegin
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onTribeTurnBegin(code: fun(turn: integer, tribe: tribeObject))
</code></pre></div></div>
<p>Registers a function that is called at the start of a tribe’s turn. See <code class="language-plaintext highlighter-rouge">onTurn</code> for interaction with other “turn” triggers.</p>
<h3 id="ontribeturnend">
  
  
    <a href="#ontribeturnend">&#128279</a> onTribeTurnEnd
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onTribeTurnEnd(code: fun(turn: integer, tribe: tribeObject))
</code></pre></div></div>
<p>Registers a function that is called at the end of a tribe’s turn. See <code class="language-plaintext highlighter-rouge">onTurn</code> for interaction with other “turn” triggers.</p>
<h3 id="onturn">
  
  
    <a href="#onturn">&#128279</a> onTurn
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onTurn(code: fun(turn: integer))
</code></pre></div></div>
<p>Registers a function that is called at the start of a turn. The basic sequence of this and other “turn” triggers is as follows:
<br /><code class="language-plaintext highlighter-rouge">onTurn</code> fires
<br />Non-tribe-specific updates take place
<br /><code class="language-plaintext highlighter-rouge">onTribeTurnBegin</code> fires for tribe 0.
<br />Tribe 0 cities are processed.
<br /><code class="language-plaintext highlighter-rouge">onCityProcessingComplete</code> fires for tribe 0 (this fires even when a tribe has no cities).
<br />Tribe 0 units move
<br /><code class="language-plaintext highlighter-rouge">onTribeTurnEnd</code> fires for tribe 0.
<br />All active tribes are processed in order according to the sequence for tribe 0
<br /><code class="language-plaintext highlighter-rouge">onTribeTurnEnd</code> fires for tribe 7.
<br /><code class="language-plaintext highlighter-rouge">onTurn</code> fires for the next turn</p>
<h3 id="onunitkilled">
  
  
    <a href="#onunitkilled">&#128279</a> onUnitKilled
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onUnitKilled(code: fun(loser: unitObject, winner: unitObject))
</code></pre></div></div>
<p>Registers a function that is called whenever a unit is killed. <code class="language-plaintext highlighter-rouge">loser</code> is the unit that is killed, <code class="language-plaintext highlighter-rouge">winner</code> is the unit responsible for it.</p>
<h3 id="onusenuclearweapon">
  
  
    <a href="#onusenuclearweapon">&#128279</a> onUseNuclearWeapon
  
  
</h3>
    
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function civ.scen.onUseNuclearWeapon(code: fun(unit: unitObject, tile: tileObject):(attackProceeds: boolean))
</code></pre></div></div>
<p>Registers a function that is called when a nuclear weapon is used. This is also called when a spy plants a nuclear device in a city. <code class="language-plaintext highlighter-rouge">unit</code> is the weapon or the spy unit, <code class="language-plaintext highlighter-rouge">tile</code> is the location of the attack. Return <code class="language-plaintext highlighter-rouge">false</code> to abort the attack, <code class="language-plaintext highlighter-rouge">true</code> to proceed.</p>
 -->
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
<!--        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
-->
<!--
-->
      </div>
      <div class="footer-col">
        <p>Reference materials and lessons for using Lua to program events for Civilization II: Test of Time</p>
      </div>
    </div>

    <div class="social-links">
<ul class="social-media-list">
  <li><a rel="me" href="https://github.com/ProfGarfield" target="_blank" title="ProfGarfield"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg>ProfGarfield</a></li>
  <li><a rel="me" href="https://www.youtube.com/user/ProfCiv2" target="_blank" title="YouTube"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#youtube"></use></svg>ProfCiv2</a></li>
  <li><a rel="me" href="https://forums.civfanatics.com/members/prof-garfield.43783/" target="_blank" title="Civfanatics Profile"><img src="/assets/civfanatics_icon.png" class="svg-icon grey"></img>Prof. Garfield</a></li>
</ul>
</div>

  </div>

</footer>
</body>

</html>
